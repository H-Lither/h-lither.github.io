<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 2021-hgame-Crypto汇总 · H-Lither</title><meta name="description" content="2021-hgame-Crypto汇总 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">2021-hgame-Crypto汇总</h1><div class="post-info">Feb 24, 2021</div><div class="post-content"><p>-Week1</p>
<h1 id="1-Transformer"><a href="#1-Transformer" class="headerlink" title="1.Transformer"></a>1.Transformer</h1><p><strong>Category</strong>: Crypto<br><strong>Points</strong>: 50 (175 solves)<br><strong>Author</strong>: XXX</p>
<h2 id="Challenge"><a href="#Challenge" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>所有人都已做好准备,月黑之时即将来临,为了击毁最后的主控能量柱,打开通往芝加哥的升降桥迫在眉睫 看守升降桥的控制员已经失踪,唯有在控制台的小房间留下来的小纸条,似乎是控制员防止自己老了把密码忘记而写下的,但似乎都是奇怪的字母组合,唯一有价值的线索是垃圾桶里的两堆被碎纸机粉碎的碎纸,随便查看几张,似乎是两份文件,并且其中一份和小纸条上的字母规律有点相像</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/Dr6LSkvY2NV5T4QG.zip?attname=Transformer%20(2).zip&download">附件</a></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h3 id="setp1："><a href="#setp1：" class="headerlink" title="setp1："></a>setp1：</h3><p><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">维吉尼亚</a></p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224031026078.png" alt="image-20210224031026078"></p>
<p>enc:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tqh ufso mnfcyh eaikauh kdkoht qpk aiud zkhc xpkkranc uayfi kfieh 2003, oqh xpkkranc fk &quot;qypth&#123;hp5d_s0n_szi^3ic&amp;qh11a_&#125;&quot;,Dai&#39;o sanyho oa pcc oqh dhpn po oqh hic.</span><br></pre></td></tr></table></figure>


<h3 id="setp2："><a href="#setp2：" class="headerlink" title="setp2："></a>setp2：</h3><p>指定<a target="_blank" rel="noopener" href="https://quipqiup.com/">词频攻击</a></p>
<p><u>qypth=hgame</u></p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224031258574.png" alt="image-20210224031258574"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mhe lift bridge console system has only used password login since 2003, the password is &quot;hgame&#123;ea5y_f0r_fun^3nd&amp;he11o_&#125;&quot;,Yon&#39;t forget to add the year at the end.</span><br></pre></td></tr></table></figure>
<p>最后提示要在flag末尾加年份。</p>
<h3 id="Getflag"><a href="#Getflag" class="headerlink" title="Getflag:"></a>Getflag:</h3><p>故完整的flag为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;ea5y_f0r_fun^3nd&amp;he11o_2021&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-まひと"><a href="#2-まひと" class="headerlink" title="2.まひと"></a>2.まひと</h1><p><strong>Category</strong>: Crypto<br><strong>Points</strong>: 50 (135 solves)<br><strong>Author</strong>: XXX</p>
<h2 id="Challenge-1"><a href="#Challenge-1" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p><strong>hint: flag的格式为hgame{xxx}（重要）</strong><br>大家好，我叫真人，来自咒术回战，你也可以叫我，缝合怪！！</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/ftUUxRafZnUpHKdj?attname=cipher%20(4)&download">附件</a></p>
<h2 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h2><h3 id="setp1：-1"><a href="#setp1：-1" class="headerlink" title="setp1："></a>setp1：</h3><p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224031717187.png" alt="image-20210224031717187"></p>
<p>使用python数据清洗一下。得到一串base64</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224031748002.png" alt="image-20210224031748002"></p>
<p>拿去解码</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224031827727.png" alt="image-20210224031827727"></p>
<h3 id="setp2"><a href="#setp2" class="headerlink" title="setp2:"></a>setp2:</h3><p>提示维吉尼亚，密钥为Liki：</p>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/weijiniyamima.php">解密</a>得：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;KccnYt!1NlPpu!zeE1&#123;C+9pfrhLB_Fz~uGy4n</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">栅栏</a>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;!!Ch~K1z+LucNe9BGclEp_ynP1fF4Yp&#123;rzntu</span><br></pre></td></tr></table></figure>
<p>翻转：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utnzr&#123;pY4Ff1Pny_pElcGB9eNcuL+z1K~hC!!&#125;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="http://www.rot13.de/index.php">rot13</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;cL4Ss1Cal_cRypTO9rAphY+m1X~uP!!&#125;</span><br></pre></td></tr></table></figure>
<p>Getflag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;cL4Ss1Cal_cRypTO9rAphY+m1X~uP!!&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-对称之美"><a href="#3-对称之美" class="headerlink" title="3.对称之美"></a>3.对称之美</h1><p><strong>Category</strong>: Crypto<br><strong>Points</strong>: 150 (82 solves)<br><strong>Author</strong>: XXX</p>
<h2 id="Challenge-2"><a href="#Challenge-2" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>美术大师 Liki 总说，对称是世界上最美的结构…</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/BFfP584qk6NoibMz.py?attname=task%20(4).py&download">附件</a></p>
<h2 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h2><p>约束条件：1：明文为ascii的可见字符，2：明文又 hgame 字符根据上面条件，爆破key即可，得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Symmetry in art is when the elements of </span><br><span class="line">a painting or drawing balance each other </span><br><span class="line">out. This could be the objects themselves, </span><br><span class="line">but it can also relate to colors and </span><br><span class="line">other compositional techniques.</span><br><span class="line">You may not realize it, but your brain </span><br><span class="line">is busy working behind the scenes to seek </span><br><span class="line">out symmetry when you look at a painting. </span><br><span class="line">There are several reasons for this. The </span><br><span class="line">first is that we&#39;re hard-wired to look for </span><br><span class="line">it. Our ancient ancestors may not have had </span><br><span class="line">a name for it, but they knew that their </span><br><span class="line">own bodies were basically symmetrical, as </span><br><span class="line">were those of potential predators or prey. </span><br><span class="line">Therefore, this came in handy whether </span><br><span class="line">choosing a mate, catching dinner or </span><br><span class="line">avoiding being on the menu of a snarling, </span><br><span class="line">hungry pack of wolves or bears!</span><br><span class="line">Take a look at your face in the mirror </span><br><span class="line">and imagine a line straight down the </span><br><span class="line">middle. You&#39;ll see both sides of your </span><br><span class="line">face are pretty symmetrical. This is </span><br><span class="line">known as bilateral symmetry and it&#39;s </span><br><span class="line">where both sides either side of this </span><br><span class="line">dividing line appear more or less the same.</span><br><span class="line">So here is the flag: </span><br><span class="line">hgame&#123;X0r_i5-a_uS3fU1+4nd$fUNny_C1pH3r&#125;</span><br><span class="line"></span><br><span class="line">isN0NCe6yBIPXTcl</span><br></pre></td></tr></table></figure>
<h2 id="Getflag-1"><a href="#Getflag-1" class="headerlink" title="Getflag:"></a>Getflag:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;X0r_i5-a_uS3fU1+4nd$fUNny_C1pH3r&#125;</span><br></pre></td></tr></table></figure>
<p>-week2</p>
<h1 id="1-signin"><a href="#1-signin" class="headerlink" title="1.signin"></a>1.signin</h1><h2 id="Challenge-3"><a href="#Challenge-3" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>描述 签到题 233</p>
<p>题目地址 </p>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/koY9hA7C3QhHZx18.py?attname=task%20(9).py&download">附件</a></p>
<p>基准分数 150</p>
<p>当前分数 150</p>
<p>完成人数 83</p>
</blockquote>
<h2 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224035200644.png" alt="image-20210224033622881"></p>
<h3 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h3><p>费马小定理+模运算+模逆运算<br>$$<br>\because a^{p}\equiv a mod p<br>$$</p>
<p>$$<br>\therefore c\equiv (a^{p}*m) mod p\equiv (ab) modp<br>$$</p>
<p>$$<br>\therefore m\equiv c*a^{-1} mod p<br>$$</p>
<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse,long_to_bytes</span><br><span class="line">d=inverse(a,p)</span><br><span class="line">m=c*d%p</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;hgame&#123;M0du1@r_m4th+1s^th3~ba5is-Of=cRypt0!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="Getflag-2"><a href="#Getflag-2" class="headerlink" title="Getflag"></a>Getflag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;M0du1@r_m4th+1s^th3~ba5is-Of&#x3D;cRypt0!!&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-gcd-or-more"><a href="#2-gcd-or-more" class="headerlink" title="2.gcd or more?"></a>2.gcd or more?</h1><h2 id="Challenge-4"><a href="#Challenge-4" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>描述</p>
<p>GCD…?</p>
<p>题目地址 </p>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/RgIgZh0F0O2DDBmO.py?attname=task%20(10).py&download">附件</a></p>
<p>基准分数 200</p>
<p>当前分数 200</p>
<p>完成人数 91</p>
</blockquote>
<h2 id="Solution-4"><a href="#Solution-4" class="headerlink" title="Solution"></a>Solution</h2><h3 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224035200644.png" alt="image-20210224035200644"></p>
<p>思路：</p>
<p>看到e=2，且已知p,q猜测 为RSA 的<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/5113">rabin</a>的加密算法</p>
<h3 id="推导："><a href="#推导：" class="headerlink" title="推导："></a>推导：</h3><h4 id="加密过程："><a href="#加密过程：" class="headerlink" title="加密过程："></a>加密过程：</h4><p>选择两个大素数p和q做为私钥</p>
<p>计算n = p * q做为公钥</p>
<p>若明文为m，则密文为<br>$$<br>c ≡ m^2 (mod n)<br>$$</p>
<h4 id="解密过程："><a href="#解密过程：" class="headerlink" title="解密过程："></a>解密过程：</h4><p>$$<br>r\equiv \sqrt{c} (mod p)<br>$$</p>
<p>$$<br>s\equiv \sqrt{c} (mod q)<br>$$</p>
<p>根据欧拉判别式，满足p为素数，gcd(c,p)=1</p>
<p>则有<br>$$<br>a^{(p-1)/2}\equiv 1 modp<br>$$</p>
<p>$$<br>\because r^{2} \equiv cmod p<br>$$</p>
<p>$$<br>\therefore r^{2}\equiv c  c^{(p-1)/2}modp \equiv c^{(p+1)/2}mod p \equiv (c^{(p+1)/4})^{2}modp<br>$$</p>
<p>$$<br>\therefore r \equiv (c^{(p+1)/4})modp<br>$$</p>
<p>$$<br>s \equiv  (c^{(q+1)/4})modq<br>$$</p>
<p>根据扩展欧几里得算法：<br>$$<br>ap + bq ≡ 1 (mod n)<br>$$</p>
<p>$$<br>a=p^{-1} (mod q)，b=q^{-1} (mod p)<br>$$</p>
<p>$$<br>x_{1}=(aps+bqr)mod n<br>$$</p>
<p>$$<br>x2=n-x_{1}<br>$$</p>
<p>$$<br>x3=(aps-bqr)mod n<br>$$</p>
<p>$$<br>x4=n-x_{3}<br>$$</p>
<h3 id="脚本："><a href="#脚本：" class="headerlink" title="脚本："></a>脚本：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">85228565021128901853314934583129083441989045225022541298550570449389839609019</span></span><br><span class="line">q = <span class="number">111614714641364911312915294479850549131835378046002423977989457843071188836271</span></span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">c=<span class="number">7665003682830666456193894491015989641647854826647177873141984107202099081475984827806007287830472899616818080907276606744467453445908923054975393623509539</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rabin_decrypt</span>(<span class="params">c, p, q, e=<span class="number">2</span></span>):</span></span><br><span class="line">    n = p * q</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">    mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">    yp = gmpy2.invert(p, q)</span><br><span class="line">    yq = gmpy2.invert(q, p)</span><br><span class="line">    r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">    rr = n - r</span><br><span class="line">    s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">    ss = n - s</span><br><span class="line">    <span class="keyword">return</span> (r, rr, s, ss)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = rabin_decrypt(c, p, q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[i])[<span class="number">2</span>:]))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#b&#x27;z\x95\x82\x00R3\x1d\x11\xb3\x02Q\xb8\x1f\xcd\xe0\xd0\xbeC\xc31%\xa8]* \t\xdb\xf1v\x87O\xf9 \x15\xbc\xcc+\xe0\xebf\xc4\xd4k\nJ\xfbN\x03\\\xcc\x7f\x00\xa9\x90\xd8l\xef\x98\xce^\xd3\xbd72&#x27;</span></span><br><span class="line"><span class="comment">#b&#x27;;\x0b\xe7ra \x82\x1fXQ/\xa1V.\xb9\x91\xc2\xd1&#123;\x9d\xe4;n\x9f\xbb\xd7\xeb\x15\xa8\xc6b\x1e\xb0d\x04^\x000\x0f\xa8\x9a\xfe\xa4\x05|\x9d\xa4&#125;s\x05z\x94\xe9\x80\xda=97R\x00?6A\xa3&#x27;</span></span><br><span class="line"><span class="comment">#b&#x27;\xb5\xa1ir\xb3S\x9f1\x0bS\x81Yu\xfc\x9ab\x81\x15&gt;\xcf\t\xe3\xcb\xc9\xdb\xe1\xc7\x07\x1fMI\xb0o\x0c[\xae\xf8\x98\x93\xcb\xfbT\xa5\xdah&amp;\x8dLc\xa0\x80j-\xd1?0\xca]\xee\xf7\xaa\x7f9X&#x27;</span></span><br><span class="line"><span class="comment">#b&#x27;hgame&#123;3xgCd~i5_re4l1y+e@sy^r1ght?&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="Getflag-3"><a href="#Getflag-3" class="headerlink" title="Getflag"></a>Getflag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;3xgCd~i5_re4l1y+e@sy^r1ght?&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-WhitegiveRSA"><a href="#3-WhitegiveRSA" class="headerlink" title="3.WhitegiveRSA"></a>3.WhitegiveRSA</h1><p><del>手速快拿了一血hhh</del></p>
<h2 id="Challenge-5"><a href="#Challenge-5" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>描述</p>
<p>N = 882564595536224140639625987659416029426239230804614613279163<br>e = 65537<br>c = 747831491353896780365654517748216624798517769637260742155527</p>
<p>题目地址 </p>
<p><a target="_blank" rel="noopener" href="https://www.baidu.com/">https://www.baidu.com</a></p>
<p>基准分数 150</p>
<p>当前分数 150</p>
<p>完成人数 187</p>
</blockquote>
<h2 id="Solution-5"><a href="#Solution-5" class="headerlink" title="Solution"></a>Solution</h2><h3 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">N &#x3D; 882564595536224140639625987659416029426239230804614613279163</span><br><span class="line">e &#x3D; 65537</span><br><span class="line">c &#x3D; 747831491353896780365654517748216624798517769637260742155527</span><br></pre></td></tr></table></figure>
<p>通过<a target="_blank" rel="noopener" href="http://www.factordb.com/">在线网站</a>将N分解为p,q，算出欧拉值，求逆元。</p>
<h3 id="脚本：-1"><a href="#脚本：-1" class="headerlink" title="脚本："></a>脚本：</h3><p>教科书般的脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">882564595536224140639625987659416029426239230804614613279163</span></span><br><span class="line">p=<span class="number">857504083339712752489993810777</span></span><br><span class="line">q=<span class="number">1029224947942998075080348647219</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">N=p*q</span><br><span class="line">c = <span class="number">747831491353896780365654517748216624798517769637260742155527</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)<span class="comment">#计算欧拉值</span></span><br><span class="line">d=invert(e,phi)<span class="comment">#求逆元</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,N)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"><span class="comment">#hgame&#123;w0w~yOU_kNoW+R5@!&#125;</span></span><br></pre></td></tr></table></figure>
<p>Getflag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#hgame&#123;w0w~yOU_kNoW+R5@!&#125;</span><br></pre></td></tr></table></figure>
<h1 id="4-The-Password"><a href="#4-The-Password" class="headerlink" title="4.The Password"></a>4.The Password</h1><h2 id="Challenge-6"><a href="#Challenge-6" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>描述</p>
<p>Hint</p>
<p>题目地址 </p>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/Y1dSX4zx6JTyjGUa.txt?attname=flag.txt&download">附件</a></p>
<p>基准分数 250</p>
<p>当前分数 250</p>
<p>完成人数 40</p>
</blockquote>
<h2 id="Solution-6"><a href="#Solution-6" class="headerlink" title="Solution"></a>Solution</h2><h3 id="题目描述-3"><a href="#题目描述-3" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224035200644.png" alt="image-20210224045847254"></p>
<h3 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h3><p>注意位数，利用Z3一把梭</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rol</span>(<span class="params">x,n</span>):</span></span><br><span class="line">    <span class="comment">#bits = len(bin(x)[2:])</span></span><br><span class="line">    bits=<span class="number">64</span></span><br><span class="line">    res = (x&lt;&lt;n | x&gt;&gt;(bits-n)) % <span class="built_in">pow</span>(<span class="number">2</span>,bits)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ror</span>(<span class="params">x,n</span>):</span></span><br><span class="line">    <span class="comment">#bits = len(bin(x)[2:])</span></span><br><span class="line">    bits=<span class="number">64</span></span><br><span class="line">    res = (x&gt;&gt;n | x&lt;&lt;(bits-n)) % <span class="built_in">pow</span>(<span class="number">2</span>,bits)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s= Solver()</span><br><span class="line">x = BitVec(<span class="string">&#x27;x1&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">n = <span class="number">10750832281632461</span></span><br><span class="line">y = <span class="number">4622436850708129231</span></span><br><span class="line">s.add(y==x^n^ror(x,<span class="number">2</span>)^rol(x,<span class="number">5</span>))</span><br><span class="line"><span class="keyword">if</span>(s.check()==sat):</span><br><span class="line">    print(s.model())</span><br><span class="line">print(long_to_bytes(<span class="number">28541</span>))</span><br><span class="line"><span class="comment">#hgame&#123;l1ne0r_a1gebr0&amp;is@1mpor10n1^1n$crypto&#125;</span></span><br><span class="line"><span class="comment"># is@1mpo</span></span><br></pre></td></tr></table></figure>
<p>Getflag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;l1ne0r_a1gebr0&amp;is@1mpor10n1^1n$crypto&#125;</span><br></pre></td></tr></table></figure>
<p>-week3</p>
<h1 id="1-LikiPrime"><a href="#1-LikiPrime" class="headerlink" title="1.LikiPrime"></a>1.LikiPrime</h1><h2 id="Challenge-7"><a href="#Challenge-7" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>描述</p>
<p>Wow! RSA!</p>
<p>题目地址 </p>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/MgAPWkFy00oiQ4Hq.py?attname=task%20(14).py&download">附件</a></p>
<p>基准分数 250</p>
<p>当前分数 250</p>
<p>完成人数 97</p>
</blockquote>
<h2 id="Solution-7"><a href="#Solution-7" class="headerlink" title="Solution"></a>Solution</h2><h3 id="题目描述-4"><a href="#题目描述-4" class="headerlink" title="题目描述"></a>题目描述</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> secrets, flag</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_prime</span>(<span class="params">secret</span>):</span></span><br><span class="line">    prime = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(secret):</span><br><span class="line">        prime = prime &lt;&lt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> prime - <span class="number">1</span></span><br><span class="line">random.shuffle(secrets)</span><br><span class="line">m = s2n(flag)</span><br><span class="line">p = get_prime(secrets[<span class="number">0</span>])</span><br><span class="line">q = get_prime(secrets[<span class="number">1</span>])</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">print(<span class="string">&quot;n = &#123;&#125;.format(n)&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;e = &#123;&#125;.format(e)&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;c = &#123;&#125;.format(c)&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>考点时<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%A2%85%E6%A3%AE%E7%B4%A0%E6%95%B0/816141?fr=aladdin">梅森素数</a>，形如<br>$$<br>2^{p}-1<br>$$<br>且p也为素数。这种素数极少，求出来的一般已经有的了。没有也不会让你来求了。。可以直接<a target="_blank" rel="noopener" href="http://www.factordb.com/">在线分解</a>网站分解，也可以用sagemath自带的这个库，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">n = <span class="comment"># ...</span></span><br><span class="line"><span class="comment"># OEIS A000668 = Mersenne primes</span></span><br><span class="line">p, q = [p <span class="keyword">for</span> p <span class="keyword">in</span> sloane.A000668.<span class="built_in">list</span>(<span class="number">20</span>) <span class="keyword">if</span> n % p == <span class="number">0</span>]</span><br><span class="line"><span class="keyword">assert</span>(p * q == n)</span><br></pre></td></tr></table></figure>






<h3 id="脚本-2"><a href="#脚本-2" class="headerlink" title="脚本"></a>脚本</h3><p>教科书般的rsa</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">85112171004548202699682247376921706310822170049506449596605272489094694769078169913536427444643923348059539685553303357068402959283732410336346786908495499835455272404598114976799751040675620090248724961755725196624736968981232907594797717674594911297025654571721076444705959941925994025587881876326124684071661759258487833509454013092230162600534437805049532976203391767621841253309155061490353976765779898103673260263284277046138106569129696359367461119410993346551086662559997234143880233707716984096158549536573345903204185471058891136629579411644600395014869324129763707721173442829417413747507906735115228072507436216848673239496769027865595311123534258218327216715156438164479086950973463760620414715166392392777823585719038933373216457664076776843311637210993857185534139160353831173240699391129449108895834003176257066851958404866252203977379245430622352781119454582690804291160749904937894023460130968917894232899713180238015952172207584948174490451766895713944377918583954162721720466330852123633189465141000750081774205629876710045199951328212405550495246751373871098151362385328589640358863246783076592542887496148788920100777571297664667280763046532115437098944418687294437211354847941011359810140895347736223247211269643004729324700608874574142088947771613140548426336361582494328933812792741938310810523864937711376836606504465147360485148597824173024797435461622518690452934528003646960161829938826295154889065542657547945750758111443390620367280139978229809991197391367271715640324247659295826733787517206928656447820295772835111179883408526557033176732913949037161555149260288126039296438306504066336673180657526025306569724504415572475120854128582407090655030686144149718875411103253788742204651998897784244213809851559940940922552774377570524418568606357490618794388734819816305957196807958279719939070837736223824436117617987784271077215426555381991904234442752175115018168609700231943658738158076672038614915004964935308202506539498450284707841</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">41828375957739916498562150033564089454607196685766541904260442111783779478003448881259851883917398226540491650790249974421433348761375420108087265365193441492024115591798281856211977623935841068707373606889975928469672361155180696958446747582303558505125525894172119462482748979179830415546690209895297586474126493598388929684833183134920353452112907198987167061098105044585807909170318967985029708406368697882436907554186979496578957639256206911189597305995766587303709636306640121243903116040005748975753810297900468282648353586372642493059445871964866880645449509031978019248839162935862835671212013942704573002667939176802097078446598228772271369057295592787389462370014353770099550136228859019199207456799498624609744443698520048775644433751112687189109828495153292638846918857866742186082632577615433638021957543480478601160384514042824863570470747168897533974487644284002353757991697097440541955604548273991455473473583441384020183547411842316568259810449435971132789383567997756581282411640148168583403411330278018826030092211967714115240196437230950122107726585257279723416798611599463449846891498358395095842305874920144300736079357052293442346036158600085141381769599195261604426403696002482660528702857432296311235916585074292227300989073775307113303590124000104989109240479552142207801941909719645227158381950197555601169308615599358660843205797023594971224801284440306219210376704987982475852756344482789213083422700344902866535047924642856392177524993058087320034253403403557381022747823176548322366626926712919607581463322878496871139928676245688578522697322271922901015545622027094702988536460050644743949752209439959259611409789014912900588129762531009273094258687802315756884583244878375932387830607995009020890397586665018337786924178871951091331865101831840990852941098394527701627331124692989708727714533649142602383695932532211578954033263670584019073734148101005669725865690669230598790955898311435368130864855761372314375508267981050947387253</span></span><br><span class="line">p=<span class="number">2</span>**<span class="number">2281</span>-<span class="number">1</span></span><br><span class="line">q=<span class="number">2</span>**<span class="number">4253</span>-<span class="number">1</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=inverse(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>


<h3 id="Getflag-4"><a href="#Getflag-4" class="headerlink" title="Getflag"></a>Getflag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b&#39;hgame&#123;Mers3nne~Pr!Me^re4l1y_s0+5O-li7tle!&#125;&#39;</span><br></pre></td></tr></table></figure>
<h1 id="2-EncryptedChats"><a href="#2-EncryptedChats" class="headerlink" title="2.EncryptedChats"></a>2.EncryptedChats</h1><h2 id="Challenge-8"><a href="#Challenge-8" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>描述</p>
<p>Switch 的病友 Million 来监狱探监…</p>
<p>题目地址 </p>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/IyPmnO6oygq74kDv.zip?attname=task_modified_06a4ff4f607bf0acb7c7bbce9f69614e.zip&download">附件</a></p>
<p>基准分数 300</p>
<p>当前分数 300</p>
<p>完成人数 21</p>
</blockquote>
<h2 id="Solution-8"><a href="#Solution-8" class="headerlink" title="Solution"></a>Solution</h2><h3 id="题目描述-5"><a href="#题目描述-5" class="headerlink" title="题目描述"></a>题目描述</h3><p>给了A,B,g,p</p>
<p>DH(DIFFIE-HELLMAN)问题，这是个公钥交换协议，由离散对数问题而诞生。一开始没审好题，没看到是加法群下的DH问题，以为是乘法群下的，用ph爆破了一天。晚上看到是加法群下的DH，那就求逆乘对方公开key再取模即为 密钥(shared secret).然后就是AES CBC解密罢了简单，就不说</p>
<h3 id="推导-1"><a href="#推导-1" class="headerlink" title="推导"></a>推导</h3><p>$$<br>A\equiv (g*a)modp<br>$$</p>
<p>$$<br>a\equiv(g^{-1}*A)modp<br>$$</p>
<p>$$<br>share=(a*B)modp<br>$$</p>
<h3 id="脚本-3"><a href="#脚本-3" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#dh_decrypt	</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_pkcs7_padded</span>(<span class="params">message</span>):</span></span><br><span class="line">    padding = message[-message[-<span class="number">1</span>]:]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(padding[i] == <span class="built_in">len</span>(padding) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(padding)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_flag</span>(<span class="params">shared_secret: <span class="built_in">int</span>, iv: <span class="built_in">str</span>, ciphertext: <span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="comment"># Derive AES key from shared secret</span></span><br><span class="line">    sha1 = hashlib.sha1()</span><br><span class="line">    sha1.update(<span class="built_in">str</span>(shared_secret).encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">    key = sha1.digest()[:<span class="number">16</span>]</span><br><span class="line">    print(key.<span class="built_in">hex</span>())</span><br><span class="line">    <span class="comment"># Decrypt flag</span></span><br><span class="line">    ciphertext = <span class="built_in">bytes</span>.fromhex(ciphertext)</span><br><span class="line">    iv = <span class="built_in">bytes</span>.fromhex(iv)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    plaintext = cipher.decrypt(ciphertext)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_pkcs7_padded(plaintext):</span><br><span class="line">        <span class="keyword">return</span> unpad(plaintext, <span class="number">16</span>).decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> plaintext.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> dh_decrypt</span><br><span class="line"><span class="comment"># p=remote(&#x27;socket.cryptohack.org&#x27;,13373)</span></span><br><span class="line"><span class="comment"># p.interactive()</span></span><br><span class="line"></span><br><span class="line">p=<span class="comment">#</span></span><br><span class="line">A=<span class="comment">#</span></span><br><span class="line">g=<span class="comment">#</span></span><br><span class="line">B=<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">d=invert(g,p)</span><br><span class="line">a=(A*d)%p</span><br><span class="line">share=(a*B)%p</span><br><span class="line">iv=<span class="string">&quot;d3811beb5cd2a4e1e778207ab541082b&quot;</span></span><br><span class="line">encrypted=<span class="string">&quot;059e9c216bcc14e5d6901bcf651bee361d9fe42f225bc0539935671926e6c092&quot;</span></span><br><span class="line">flag1= dh_decrypt.decrypt_flag(shared_secret=share,iv=iv,ciphertext=encrypted)</span><br><span class="line">iv=<span class="string">&quot;b4259ed79d050dabc7eab0c77590a6d0&quot;</span></span><br><span class="line">encrypted=<span class="string">&quot;af3fe410a6927cc227051f587a76132d668187e0de5ebf0608598a870a4bbc89&quot;</span></span><br><span class="line">flag2=dh_decrypt.decrypt_flag(shared_secret=share,iv=iv,ciphertext=encrypted)</span><br><span class="line">print(flag1+flag2)</span><br></pre></td></tr></table></figure>
<h3 id="Getflag-5"><a href="#Getflag-5" class="headerlink" title="Getflag"></a>Getflag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;AdD!tiVe-Gr0up~DH_K3y+eXch@nge^4nd&#x3D;A3S&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-HappyNewYear"><a href="#3-HappyNewYear" class="headerlink" title="3.HappyNewYear!!"></a>3.HappyNewYear!!</h1><p><del>手速快又拿了一血</del></p>
<h2 id="Challenge-9"><a href="#Challenge-9" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>描述</p>
<p>Liki 的朋友们在新年的时候给她发送了新年祝福<br>好家伙，一看就是群发的，有几个朋友发送的内容还是相同的！</p>
<p>题目地址 </p>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/tiWn2OAoRiC5a9AC.zip?attname=happynewyear_task_1e883107c8b6f99f7c0199872ba958a1%20(1).zip&download">附件</a></p>
<p>基准分数 300</p>
<p>当前分数 300</p>
<p>完成人数 56</p>
</blockquote>
<h3 id="Solution-9"><a href="#Solution-9" class="headerlink" title="Solution"></a>Solution</h3><h3 id="题目描述-6"><a href="#题目描述-6" class="headerlink" title="题目描述"></a>题目描述</h3><p>e=3，m相同。</p>
<p>$$<br>m^e≡c1(modn_1)\m^e≡c2(modn_2)\m^e≡c3(modn_3)<br>$$<br>给出了七组数据，。那就排列组合进行CRT</p>
<p>最后就是看结果刚好开立方是字符串。</p>
<h3 id="脚本-4"><a href="#脚本-4" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">params=[[<span class="number">768731284506327944113406236027267453153178504481960474163849413572959901900781941471060120664615036667721568236486104212543941626093683611820051956888999990409535944068510533828285247642295156383062225121123397420863524500301605790432399020453905305067131509497931914214431033157498386840010234482484177898191608673445690542041959091445418878375877435164674203776931738708624804301646179653019817596612876848617302959482364008286148292002918372774353441375602500755004724814787928356594079344361596836482525021434616271982920662313256530007883018720585047232121289721656963132683682023625683229940587959315583539720857557451681402228168096559968476948263356605729649774017109848808425693506724312264272613164411551780892434255749213128692122454364559986018251379167331425321803760454026945039856860491038669974395683809854790365463840636343980962376205540013015629307389934488725537142983815565534720739509012176887290320329127809218230756596181528831774086891633290341399153631178022171655153576793324046302349267421556220063264261739968103953460444018066381487941305190730721608513048181450127628562770702172658088836581698332318905758721984778545449145728049393279394785952324627362503706190204128637631213405674863660425389313259</span>,<span class="number">722725267571877807402319081826628305252544883884335241258703688920929757984818470073041479840921480077113183869560758029121565524819466778712481183488277905449328223533043391590093655773827799575075615676500130199172201779452716348108026696828323022993975174610207567571651550333881731147356813019258889551558181283524226640533248278854011492561134943798149661873706769482776061146298693713915393175945083367889987571681776927122583376239974702806044792299381370488664195802017823240811394180509440609967345141141653389746431284893972530735438955464348280960825325776483554008537527538106398207335688261344254017151889931214151508915480961509920681364352778795068266724879364096996252272841617341643666522563974346452491302969822483901472736908002176995244808285202644542949151920310938882432565101197174787422479197405599503943928375781580538374853471395003088467545128060029187794431891563377967647568991772201040537299188867383732391802781253804314567562657951501684710262276597091279719861829006628377575073875781088939946651128183090724290607438597560193321130496240482260573568646971658130695308585240404956802017929673317521572608385674052894773447205932790060730005333539795323555614705817665786476411351969424168366962370578</span> ], [<span class="number">524955549822701108820249448341549471789542970374297220719644144467046120999708435027269809717491708384591502747843811858599256578006152409861521624800414221049434790169883523654257416906811451131195855586244598374880878692418389200238536952258677438654818096236001665540878733993916070969439309600669058216532381285131220090854384696479702333190547690812990714884526122724065211294733252863353053612662498096532976972273019631446622835704720241172866721075241553118399444619649756067546482948914446034527197029043296867226467390140262361175465932673129685497666662167082114259368591713670044469780955810420060714389043507570707061129150071885165680539302629323340904857078380746639406842784054066196290404127562974351550470732956889057701068241533469665269708040337792974792839671609064624273734488264409908037327963582749939131119285299618565955038449080047185142908091099286222071106259434530841587125509988124634728986309920606439740930811537598857558982632237868734857663853645411122621117175983417162818791869180350737709034243602399686004808133116046260847513863100560285962053110278579574895754928960943506584372424062481234806423574610837438057911596190771344568064718882123247708570545980147637910744997312960997877114875563</span>,<span class="number">341106636902364624537621803937059683829500847731737217024477947229102117868841270816391462580424161421481323287279560344771837711680149251407621544732737892160496443939357041950388493554496406007658435517211507967374859158779641371713073809459356957664870385022506283994639885012608754343497740963582877475346528865751238785898641641562644419639994889039921662499512792397994326679297072288344988329863729467521185656908541750681614296631331948235836697947639517519093825102735706418368162081693311580728579264440449951888361065347124447876814670051679652280281965491150266115964128635848848265679743499256971016535195477416889144131600175159747033626985115139696085153828051183257884668367446309997650590293659781294222777784435987334384194429993199873061206563903159227361936901013994702046575677089263288115905540761147293222721696340819505305497691052766999798297905368576684359681315851605714974267829409740228043899512270242579080482164570677517245195783188509338962785491871370414414487565392656794817257748899014632689366928706013426731920865802714147114118673053353872356444566840336431784793686607763099763915943769968162453433779091468653936247489610842351714130350853888962620401435016019892000066519489369586647822582532</span> ], [<span class="number">531816715051067911629200567254640608407895151120321915934223550416084055941810057275647124365372164691799815654324843152835621657219143971510794565282438719132189708357084269561390602533348667210778967547331570345307713271797500472800693615897738386357322760213782607288672639158771643480519455699144535885754570631972814751649211026584146963569748660071519399459076694805787216533150149579905553101555997182221446716574345192297201707280470099673168021522276021573255431147391095907444654303966368362618307277890450431646680417082866906543559655835992081835168319097576418799442472634041439781110915814527860626840035884588953837943723302497813966476632638781785524454419556109443369209786353302330932241171298568309190081206636347720214268688100661670856945137179076232753814259674913102806389336950363047338944420468292248719856587641014569194752277829684619803918722245724677129232358305719548783148527753735258295780607510739074337299037254055287750082818921964088131910307180760939784520021579399465657665634960365680711736311232219221704752502361047780644838828947578962833367751773943513294960723081845674700714114613905708967183234219078662548527491691822238226973730089750314606177285702898595711912716069746542235493085749</span>,<span class="number">96655501480984228476843527875038148766862682735216531181731365068856421448884071634422050543257015201836409006098564512948671369804995159104827331853700167554494548064655395947790619030027666553546707921275511050067552520015915189711919816240838635843727117678456359153157042256845391879627204005136329626204082446757707275024018932620919979573721462329490962992796317057293975350138690301006093906543825995442041881912668467639058815752449994459671712370905576936766284703593791336731603543492278087975208438906947966054673189424532474872122585340933934837935650393646216239318131268109344918651250925428018278665569580645117439459587437729735009669592816057201053074978283319149894796397333902672858475161613255814596817201545193202169499144055305358584644635503323032680354835638327999633796089419073741897835010300917603325122563734141907765815188906909017245236242853269976816696795439826925876239600449014662736919205840699787188466436497530759889271878272675511804209502453822900397006767975864334707665149166220819464748535531766670263050223009402082194467219438612279935716319300498861153496030333202808928006701019408354471055774090532330704743753190920815655232618981877529057446430825964256948001465214314349394508264556</span> ], [<span class="number">493772253520028701228394073791118796898860642546293517165976340880188671501170757992157937835809864375957661380376149183362237960714624594301301578885724183490678033704978135608268473206365825232902155458695063561942608980565675676060170247587203833300205781482210306978615656217675258493239504539762213919984146477146352995349444904282648001338541091894423167804984256356783623092953892148062097076194840351505254447228339051915162949343535017563167413299991340194548813782360554779507722510592683811398509607473468601404587617569337150824778600883884616204746234575349549906287741463102675096118386062231492163458668021511751022439191080507345540921839703382290445797046739813648289321292589201149955672085687445193343364105492343611293348540598587286909499000234416955201612299458282688515658596600656417554161895812046994316423241245289735327450704642000340929459813500971266436908790234452643087694195334024560701562917342963860276789458845939794177422833059051673483227332372905969868740556412782843128761060670334188293944421019131514119696008065850631880588123929581097844255625593530935229341774189341909782979667383762706038731196861300615117475933625813147094849135055190312732335084507955724604696171453417718094964090327</span>,<span class="number">357103586677133190400275535608298307096755517917743991779928165944808156555143364562652658318257441161780966754082431346703420213047464905801347987429587866507784835294289240703319363713980965945263022810877492245609589053923882000898807593180841308987573262209122953930711801088265031627560104571585260900206878593365521048031056818241791513449270437055503002833594299287048995560742435886215547766657105383700364572345248814440024509278757886084274494794572349604428103225636768278633773471700470592729438598821712944805975639637427494951822994991131521067141611563925956037672180261640035716517421681741527507431981163704929952037747170161617798150545493396732644456871805542270699764392127056902381387198947947443962667595072777104565429494042828509588406057498452896606672079600318076629291832964611485077778334984817595747726526804076306703817160053516530370696172218743746676413884784385108888108803420106818173901070897426014100110652172248635456173774009497111567782846079335233333617278837527467186444919584161474044529784043912893406555209016056689227249614906221138535989446685926185643604698806909451119908925728900998397084501277736148437741526619184826982588354997162924650747731826227150677994598866694976617038952960</span> ], [<span class="number">400814713999150053337202998177245797185153318108582661287579898596310746501291974666347785576673046001863500878959207830917744556274546158919815600936114953314600540036576429657582500764669413652252770861966417840099061248948771555745832102924038855172611675048290264202872791337710865213077945592130795851795718608065812757968780578674701063411377538597424177722558867587781141897676300153523209675996201871155481412772845570976807158049274849081684209479884845355028703657648486318475977716075670243766212910039942550957289189946628261360037565354423094972917371572096203537186108596979722712819213554550645058717286550110465343100499845761528635976859006285823914211739843983972560292482778326983903018873698437828016668821516581220588836782094261582899393704029819851484331592269664479855215056764839779582417486366182524483986373098489636334412671358130389579972838029202609936524996601129648191606117951616875200119129837212604760319073283133589692257497994855882819655018727368441361317788278857721179085847352853038553208639836433059097775135452611114351766229800268321281856140246610438246783364320786390657242414430601000831387967976691362673290089725234013924339500819390840062916754623424132621350706544122257464089409619</span>,<span class="number">196373383105902290020944815248115178565096789884585292930623716947035208071024597949093015291460459688039044997141326097130071826293844614603464306742597764422862382005497313400758917851620553757103374309501021075747571843057781165101330819142446088116279098633113721577451389062207713330184173913814679087349450078308520703743712617560764419518421118924319893700795437644204733301627193873115633309760620284510790535125035058821049861371456491148507101291075161477427293354824377765129256775039894591945559511120167575652522441315757824060660730144970842971698502722588421031575495602989132763560631831054650312859575883607799879434734827000150732042760623153837096529339041007718789464168455505957010471222861988485628012999068075964645262827332446865072284660213544453081529030572364389186506108110484311864485900432885752933720505418233626286434177587041376262805920492740865402092716512672643242061407641167432424410178764502786772854859640601859309316626050634279758623225955757842810086544305493826555445120223896047747445754110537277236254307766447437586975157089685397827540671890607699289450588156013811091193850313213188596446595791898264003078214830341703064110270245588623025485564465677065014954050674151068209958156338</span> ], [<span class="number">441219832102329113941862838660943233579215441091346336934528023475304109965596676163440394813272558320918420480386749091947802455423402857125233908206867132599069595323243154174569298961794344623241293553421864069389535348543832297805982907650367142721566803315107733852453608111246057981064164247187640480712312060234169292599096087422940380874435851795847673883946134398943282297673922785786134668939454715179979246505182510338437251221569074780060511794395438999419581907256239694239236674604727404688764447352994022067990843174130240669289888289862268588307778029283493265348667415910553064457513926134377522099641209108448559373422305901757344324758407462166774699512993336120173336911210734744313930970281023299709778006083933174113456436965150432387778607639217894522770756209157735203091790545289813873886244335031912734705230434179583023235199153300263399767468586679972093973609985111254951924071949408463935260725701129931726900345186925871556853670570762826122383762006869109981003180805851519716186506371242901187230433096494812063568936279012557322219782284461140361225650340807095328622016565443274256310194921729305097890315074292153303546235677671541793456589738387043928232044507842169173330728718482770626654501523</span>,<span class="number">343558577020588714429313020041093297550600511001840154137552216575748946157961591099597309730875847249609067088895567357040752583678766229661761073029178667941759812656095394713728367061506713413650132129245164858512061430944849306322427733297033654152161512931139895523891447055784674776356336721195602898082264703411052396223706491835615239898963965039349867576628181946954585002705252796231016445166027513456849060948360498081892030697906086173612576083651879166491789946438067179662219651062279317002050789871120333850272751224872129535742685201837098575125361312611392050300073462884046822571642883949673321736837838379514540827860219307938135197101094531402063240331559853201121385391076154875363696159228373299490035401297769928627372721885488091110000395742964536445855367746227395783716581955884641531132839080847770052153020914740561915612109449417203852452084551679817129684835596664222472806271699238429017096741164052056835664191547244480985004136162585874727015248038703376279042870253365410963230937309995702792020342080115661150163434949942290275789227674559517957243060077741816736950124894466197373209308598030218454826136754312091821659566499445097655483610010997986426784494466843809743836689209926943448276851733</span> ], [<span class="number">320869957563788427035277998523618265705625973417036901203569472342030237447625011870979141578128136960129467546914523329260071050471008896398606988171189642059908517956020915451465313985689287777861360309556861849062064900403692083060786557290591231962941942100771713703136018889848261749140840347546977823595556802430254803837030344591646012857122213227115215674470388548652140381296705772500445572224924018905225174265663584819356114341255408979866800339484643585303306817447453000684770518093577661102544212109378828711785073514863402442870264355300371516683912671007573320059261257897651899697566804513319774954294708303168788292037857134628186553450976637858562675039807897112079750384830264618639239956765667388939331303314191813126254254914926384279494115576997773080256600900034563434959593677148531401160281960526061723479161754555193979726656961515374019212153726594807142456303698775715290518062768887156433902187122160641097916121097179118289646514217696314956474472626420868486152421013284784863653299930875253371982327367991139126828286729539033382650687859412868137579309775440698502848241122394423129771442338402870863767769545005951064956498742874485207824630520777152431261010818838138655082911865834699807375008861</span>,<span class="number">78140898568960172537532399957542065079754785608196175653725188831315142763849427144477433109881196560183622027227087954674199188991855929146336784979764720497547685824735751948676073196869027199411668951578490599507331800328072699193016348570092942269398714025948091737017548105562834031699831877517521836116912407428829037729994348603578694187241194587650053966682616443757430366693816438822541572320426819962696790047344705617241989403482962642561340363553100861232083902828830416053526478120239416765009622649261419311221132287115995483736302156498238644085182807103157307755108774079839474373171678479879270772376918459752331416572057373104068315516826270820079207687778179443170979119272546974948398836020966295976732842161084596604333609962435508857188202619164351406760248161996398928399808794165750688251550333360521545271424876496939865803880625334341137443221883906301968050670219384464251470416581899246708055363762134459566859899715206435140188997349196902765578570516978378759650864568014586614460583304460504318729333658817066272120984875742815218722200593432648242043375439670923950493477821363923796229165231700852653002648050645561521640741356788087870305958215222979881662007309583380284362915245390595921375463156</span> ]]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">ns, cs</span>):</span></span><br><span class="line">    M = reduce(operator.mul, ns)</span><br><span class="line">    Mi = [M//n <span class="keyword">for</span> n <span class="keyword">in</span> ns]</span><br><span class="line">    ti = [<span class="built_in">pow</span>(Mi, -<span class="number">1</span>, n) <span class="keyword">for</span> Mi, n <span class="keyword">in</span> <span class="built_in">zip</span>(Mi, ns)]</span><br><span class="line">    x = <span class="built_in">sum</span>([c*t*m <span class="keyword">for</span> c, t, m <span class="keyword">in</span> <span class="built_in">zip</span>(cs, ti, Mi)]) % M</span><br><span class="line">    r, exact = gmpy2.iroot(x, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">if</span> exact:</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> cb <span class="keyword">in</span> combinations(params, <span class="number">3</span>):</span><br><span class="line">    ns = [x[<span class="number">0</span>] <span class="keyword">for</span> x <span class="keyword">in</span> cb]</span><br><span class="line">    cs = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> cb]</span><br><span class="line">    r = solve(ns, cs)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    print(number.long_to_bytes(r))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;Hello Liki4:\n\nI am afraid that there are too many blessings on the 30th night, you will not see my greetings, \nI am afraid that the firecrackers in the first grade are too noisy, you will not hear my blessings, \n\n@ind3r~YOu^9ot=i7&#125;&#x27;</span></span><br><span class="line"><span class="comment">#b&quot;I am afraid the dishes in the second grade are too fragrant, you will not reply my text messages, \nso I won&#x27;t give you New Year greetings this year, I hope you don&#x27;t know how to praise, good night.\n\nhgame&#123;!f+y0u-pl4y_rem&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Getflag-6"><a href="#Getflag-6" class="headerlink" title="Getflag"></a>Getflag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;!f+y0u-pl4y_rem@ind3r~YOu^9ot&#x3D;i7&#125;</span><br></pre></td></tr></table></figure>
<p>-week4</p>
<h1 id="1-寻宝大冒险1"><a href="#1-寻宝大冒险1" class="headerlink" title="1.寻宝大冒险1"></a>1.寻宝大冒险1</h1><p><del>抢了一个三血</del></p>
<h2 id="Challenge-10"><a href="#Challenge-10" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>描述</p>
<p>nc 182.92.108.71 30641</p>
<p>题目地址 </p>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/nil2NEBlE2eeay9s.py?attname=%E5%AF%BB%E5%AE%9D%E5%A4%A7%E5%86%92%E9%99%A91.py&download">附件</a></p>
<p>基准分数 350</p>
<p>当前分数 350</p>
<p>完成人数 17</p>
</blockquote>
<h2 id="Solution-10"><a href="#Solution-10" class="headerlink" title="Solution"></a>Solution</h2><h3 id="题目描述-7"><a href="#题目描述-7" class="headerlink" title="题目描述"></a>题目描述</h3><p>就是LCG全家桶（见我之前的<a target="_blank" rel="noopener" href="https://h-lither.github.io/2021/01/28/Crypto-LCG/">博客</a>），不过数都是随机的，可能不能满足标准LCG。故要写脚本爆破。</p>
<h3 id="脚本-5"><a href="#脚本-5" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun1</span>(<span class="params">a,m,x1,x2</span>):</span></span><br><span class="line">    a = <span class="built_in">int</span>(a)</span><br><span class="line">    n = <span class="built_in">int</span>(m)</span><br><span class="line">    output1 = <span class="built_in">int</span>(x1)</span><br><span class="line">    output2 = <span class="built_in">int</span>(x2)</span><br><span class="line">    b = (output2 - a * output1) % n</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun2</span>(<span class="params">m,x3,x4,x5</span>):</span></span><br><span class="line">    n = <span class="built_in">int</span>(m)</span><br><span class="line">    output = [<span class="built_in">int</span>(x3), <span class="built_in">int</span>(x4), <span class="built_in">int</span>(x5)]</span><br><span class="line">    d = inverse((output[<span class="number">1</span>] - output[<span class="number">0</span>]), n)</span><br><span class="line">    a = (output[<span class="number">2</span>] - output[<span class="number">1</span>]) * inverse((output[<span class="number">1</span>] - output[<span class="number">0</span>]), n) % n</span><br><span class="line">    ani = inverse(a, n)</span><br><span class="line">    b = (output[<span class="number">1</span>] - a * output[<span class="number">0</span>]) % n</span><br><span class="line">    <span class="keyword">return</span> a ,b</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun3</span>(<span class="params">x6,x7,x8,x9,x10,x11,x12</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd, invert</span><br><span class="line">    s = [<span class="built_in">int</span>(x6),</span><br><span class="line">         <span class="built_in">int</span>(x7),</span><br><span class="line">         <span class="built_in">int</span>(x8),</span><br><span class="line">         <span class="built_in">int</span>(x9),</span><br><span class="line">         <span class="built_in">int</span>(x10),</span><br><span class="line">         <span class="built_in">int</span>(x11),</span><br><span class="line">         <span class="built_in">int</span>(x12)</span><br><span class="line">         ]</span><br><span class="line">    t = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        t.append((s[i] - s[i - <span class="number">1</span>]))</span><br><span class="line">    all_n = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        all_n.append(gcd((t[i + <span class="number">1</span>] * t[i - <span class="number">1</span>] - t[i] * t[i]), (t[i + <span class="number">2</span>] * t[i] - t[i + <span class="number">1</span>] * t[i + <span class="number">1</span>])))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> all_n:</span><br><span class="line">        n=<span class="built_in">abs</span>(n)</span><br><span class="line"></span><br><span class="line">    x=all_n[<span class="number">2</span>]</span><br><span class="line">    y=all_n[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> x <span class="keyword">if</span> x &lt; y <span class="keyword">else</span> y</span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> k&lt;<span class="number">1</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p=remote(<span class="string">&#x27;182.92.108.71&#x27;</span>,<span class="number">30641</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># context.log_level = &#x27;Debug&#x27;</span></span><br><span class="line">        n=p.recvline()[<span class="number">1</span>:-<span class="number">2</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        a1=n[:<span class="number">20</span>].replace(<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        m1=n[<span class="number">20</span>:].replace(<span class="string">&#x27;, &#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        x1=p.recvline()[<span class="number">0</span>:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        x2=p.recvline()[<span class="number">0</span>:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        f1=fun1(a1,m1,x1,x2)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(f1))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        m2=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        x3=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        x4=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        x5=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        f21,f22=fun2(m2,x3,x4,x5)</span><br><span class="line"></span><br><span class="line">        p.sendline(<span class="built_in">str</span>(f21))</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(f22))</span><br><span class="line"></span><br><span class="line">        x6=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        x7=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        x8=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        x9=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        x10=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        x11=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        x12=p.recvline()[:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        f3=fun3(x6,x7,x8,x9,x10,x11,x12)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(f3))</span><br><span class="line">        print(<span class="string">&#x27;==========&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        dd=p.recvline()[<span class="number">0</span>:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> dd ==<span class="string">&#x27;win&#x27;</span>:</span><br><span class="line">            print(p.recvline()[<span class="number">0</span>:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">            k=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224055544355.png" alt="image-20210224055544355"></p>
<h3 id="Getflag-7"><a href="#Getflag-7" class="headerlink" title="Getflag"></a>Getflag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;Cracking^prng_Linear)Congruential&amp;Generators&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-寻宝大冒险2"><a href="#2-寻宝大冒险2" class="headerlink" title="2.寻宝大冒险2"></a>2.寻宝大冒险2</h1><h2 id="Challenge-11"><a href="#Challenge-11" class="headerlink" title="Challenge"></a>Challenge</h2><blockquote>
<p>描述</p>
<p>nc 182.92.108.71 30607</p>
<p>题目地址 </p>
<p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/yC6oZlPV8OUhYsEb.py?attname=%E5%AF%BB%E5%AE%9D%E5%A4%A7%E5%86%92%E9%99%A92.py&download">附件</a></p>
<p>基准分数 300</p>
<p>当前分数 300</p>
<p>完成人数 14</p>
</blockquote>
<h2 id="Solution-11"><a href="#Solution-11" class="headerlink" title="Solution"></a>Solution</h2><h3 id="题目描述-8"><a href="#题目描述-8" class="headerlink" title="题目描述"></a>题目描述</h3><p>LSRF，不过在返回的时候使用了|，跟^只差在都为1的时候还没1.故也存在概率。</p>
<p>当等于20时候，没有正确的话再一次重新运行程序。直到正确为止。</p>
<h3 id="脚本-6"><a href="#脚本-6" class="headerlink" title="脚本"></a>脚本</h3><p>(没有优化，代码有点难看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span>(<span class="params">data</span>):</span></span><br><span class="line"></span><br><span class="line">    data = <span class="built_in">bin</span>(<span class="built_in">int</span>(data,<span class="number">16</span>))[<span class="number">2</span>:]</span><br><span class="line">    LEN = <span class="number">40</span></span><br><span class="line">    LMASK = <span class="number">2</span> ** (LEN + <span class="number">1</span>) - <span class="number">1</span></span><br><span class="line">    MASK = <span class="number">0b1011001010001010000100001000111011110101</span></span><br><span class="line">    key = <span class="number">0b0</span></span><br><span class="line">    init = <span class="built_in">int</span>(data[:LEN - <span class="number">1</span>], <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, LEN):  </span><br><span class="line">        i = init &amp; MASK &amp; LMASK</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(LEN - <span class="number">1</span>):</span><br><span class="line">            output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">            i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">        bit = <span class="built_in">int</span>(data[LEN - n - <span class="number">1</span>]) ^ output</span><br><span class="line">        key |= bit &lt;&lt; n</span><br><span class="line">        init = (init &gt;&gt; <span class="number">1</span>) | (bit &lt;&lt; (LEN - <span class="number">2</span>))  </span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LXFIQNN</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, init, mask, length</span>):</span></span><br><span class="line">        self.init = init</span><br><span class="line">        self.mask = mask</span><br><span class="line">        self.lengthmask = <span class="number">2</span>**(length+<span class="number">1</span>)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        nextdata = (self.init &lt;&lt; <span class="number">1</span>) &amp; self.lengthmask</span><br><span class="line"></span><br><span class="line">        i = self.init &amp; self.mask &amp; self.lengthmask</span><br><span class="line"></span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line"></span><br><span class="line">            output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            i = i &gt;&gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        nextdata ^= output</span><br><span class="line"></span><br><span class="line">        self.init = nextdata</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">random</span>(<span class="params">self, nbit</span>):</span></span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">            output &lt;&lt;= <span class="number">1</span></span><br><span class="line">            <span class="comment"># print(&#x27;===&#x27;+str(output))</span></span><br><span class="line">            d=self.<span class="built_in">next</span>()</span><br><span class="line"></span><br><span class="line">            output ^= d</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;182.92.108.71&#x27;</span>,<span class="number">30607</span>)</span><br><span class="line"><span class="comment"># p.interactive()</span></span><br><span class="line">d=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    print(p.recvline()[<span class="number">0</span>:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="comment"># print(p.recvline()[:].decode(&#x27;utf-8&#x27;))</span></span><br><span class="line">    p.sendline(<span class="string">&#x27;122&#x27;</span>)</span><br><span class="line">    dd=<span class="built_in">hex</span>(<span class="built_in">int</span>(p.recvline()[<span class="number">27</span>:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>).strip()))</span><br><span class="line">    d+=dd[<span class="number">2</span>:]</span><br><span class="line">print(d)</span><br><span class="line">key=fun(d)</span><br><span class="line">prng = LXFIQNN(key, <span class="number">0b1011001010001010000100001000111011110101</span>, <span class="number">40</span>)</span><br><span class="line">t=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    secret = prng.random(<span class="number">4</span>)</span><br><span class="line">    t+=<span class="built_in">hex</span>(secret)[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">190</span>):</span><br><span class="line">        secret = prng.random(<span class="number">4</span>)</span><br><span class="line">        print(p.recvline()[<span class="number">0</span>:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">        p.sendline(<span class="built_in">str</span>(secret))</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)<span class="comment">#防止交互过快，还没接收完信息，服务器中断链接。</span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210224060035458.png" alt="image-20210224060035458"></p>
<h3 id="Getflag-8"><a href="#Getflag-8" class="headerlink" title="Getflag"></a>Getflag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;lfsr_121a111y^use-in&amp;crypto&#125;</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2021/02/24/%E8%9A%81%E6%99%AF%E6%9D%AF-Crypto-wp/" class="prev">PREV</a><a href="/2021/02/24/Crypto-RSA/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 蚁景杯-Crypto-wp · H-Lither</title><meta name="description" content="蚁景杯-Crypto-wp - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">蚁景杯-Crypto-wp</h1><div class="post-info">Feb 24, 2021</div><div class="post-content"><h1 id="1-AES-With-RSA"><a href="#1-AES-With-RSA" class="headerlink" title="1.AES With RSA"></a>1.AES With RSA</h1><h2 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&quot;flag&#123;&quot;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">padding</span>(<span class="params">s,blocklen</span>):</span></span><br><span class="line">    length = (blocklen-<span class="built_in">len</span>(s)) % blocklen</span><br><span class="line">    <span class="keyword">return</span> s + <span class="built_in">chr</span>(length) * length</span><br><span class="line">key = urandom(<span class="number">16</span>)</span><br><span class="line">iv = urandom(<span class="number">16</span>)</span><br><span class="line">m = padding(flag,<span class="number">16</span>)</span><br><span class="line">c = AES.new(key, AES.MODE_CBC, iv).encrypt(m)</span><br><span class="line">print(c.<span class="built_in">hex</span>())</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(key)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">print(<span class="built_in">hex</span>(n).strip(<span class="string">&quot;L&quot;</span>))</span><br><span class="line">print(<span class="built_in">hex</span>(c).strip(<span class="string">&quot;L&quot;</span>))</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(iv)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">print(<span class="built_in">hex</span>(n).strip(<span class="string">&quot;L&quot;</span>))</span><br><span class="line">print(<span class="built_in">hex</span>(c).strip(<span class="string">&quot;L&quot;</span>))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">abd2524c33d3192c4c34dcc34d91ff5d351b4612b38f178f743e0f093d1411a0</span></span><br><span class="line"><span class="string">0x9a40bc6f9d9f2abfa62f0fd6d4bd8b90d0c93f1a0e20edd5604b9be3f985ce417937fa95596fafa23c89251954a045a5b53b8e09953d20fb300364d40a1462190346c8032ddda62fb9c94bbfa98bbb7228bf15d8f1b8e214e66012821474d3ee891e64d675b83455496848a461704b08efddb7856a82d2181037a06461921d31</span></span><br><span class="line"><span class="string">0x70150c917bb393186dd4e3db75acca61502d36d29c617831e0207d9caa86d93c70aeb909ab50878490776fa1fabac8dc0fc0010d1226d3c71a8956cf0d33102935af63f6b566fb9e824e7c52beaf6808d0aee39641cd172366cef2b692cc493e20c1cdec1fd98137b0a88cd58f1db999249b29d425e18a8e72fcb549af54869e</span></span><br><span class="line"><span class="string">0xf285514f868026e1f0bbe46ef4566ce3a32d294bad7ef529fa30a7160a97adc6a6f728fd0783f017b42aad70c00fb88ce9025cea7ceddd5840a741fc3830eef90071bb296e46189b138ab161e2eccc5c22ba40e23497e9617b925e982557c43b4ea5e6597867cdb0f85a67a4af09389d3b9e2e1d23c78a956481e025b195e4ed</span></span><br><span class="line"><span class="string">0xee1259277e826884f3c12b928126fed7901821145d8106e32f4ec77483da366af12cc64a9a0228a03104a929f7b1316110d5379eff79bad722cdf22e1b9ac07282afcebf11806fc29a2a42081ba4dbba58fdc6c1608ca00c56d83e22251e441d87ec77cbe34554ef7d15c5bb02d1c0b7890d1ea499e52f41b90cb0c32913de85</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>


<h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">n1=<span class="number">0x9a40bc6f9d9f2abfa62f0fd6d4bd8b90d0c93f1a0e20edd5604b9be3f985ce417937fa95596fafa23c89251954a045a5b53b8e09953d20fb300364d40a1462190346c8032ddda62fb9c94bbfa98bbb7228bf15d8f1b8e214e66012821474d3ee891e64d675b83455496848a461704b08efddb7856a82d2181037a06461921d31</span></span><br><span class="line">print(n1)</span><br><span class="line">c1=<span class="number">0x70150c917bb393186dd4e3db75acca61502d36d29c617831e0207d9caa86d93c70aeb909ab50878490776fa1fabac8dc0fc0010d1226d3c71a8956cf0d33102935af63f6b566fb9e824e7c52beaf6808d0aee39641cd172366cef2b692cc493e20c1cdec1fd98137b0a88cd58f1db999249b29d425e18a8e72fcb549af54869e</span></span><br><span class="line">n2=<span class="number">0xf285514f868026e1f0bbe46ef4566ce3a32d294bad7ef529fa30a7160a97adc6a6f728fd0783f017b42aad70c00fb88ce9025cea7ceddd5840a741fc3830eef90071bb296e46189b138ab161e2eccc5c22ba40e23497e9617b925e982557c43b4ea5e6597867cdb0f85a67a4af09389d3b9e2e1d23c78a956481e025b195e4ed</span></span><br><span class="line">c2=<span class="number">0xee1259277e826884f3c12b928126fed7901821145d8106e32f4ec77483da366af12cc64a9a0228a03104a929f7b1316110d5379eff79bad722cdf22e1b9ac07282afcebf11806fc29a2a42081ba4dbba58fdc6c1608ca00c56d83e22251e441d87ec77cbe34554ef7d15c5bb02d1c0b7890d1ea499e52f41b90cb0c32913de85</span></span><br><span class="line">p=gcd(n1,n2)</span><br><span class="line">print(p)</span><br><span class="line">p=<span class="number">13012464124288041928877171589688144718225352447713360217690273042701544998888503005661632679150877660590319673228655642180011116651614192152211694073941897</span></span><br><span class="line">q1=n1//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">d1=inverse(e,phi)</span><br><span class="line">q2=n2//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d2=inverse(e,phi)</span><br><span class="line">key = long_to_bytes(<span class="built_in">pow</span>(c1,d1,n1))</span><br><span class="line">iv =long_to_bytes(<span class="built_in">pow</span>(c2,d2,n2))</span><br><span class="line">m=<span class="string">&#x27;abd2524c33d3192c4c34dcc34d91ff5d351b4612b38f178f743e0f093d1411a0&#x27;</span></span><br><span class="line">c = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">c=c.decrypt(long_to_bytes(<span class="built_in">int</span>(m,<span class="number">16</span>)))</span><br><span class="line">print(c)</span><br><span class="line"><span class="comment">#b&#x27;flag&#123;AES_W1th_RSA_1s_Fun&#125;\x07\x07\x07\x07\x07\x07\x07&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="2-GMC"><a href="#2-GMC" class="headerlink" title="2.GMC"></a>2.GMC</h1><h2 id="题目：-1"><a href="#题目：-1" class="headerlink" title="题目："></a>题目：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;xxx&#125;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gmc</span>(<span class="params">a, p</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(a, (p-<span class="number">1</span>)//<span class="number">2</span>, p) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_key</span>():</span></span><br><span class="line">    [gp,gq] = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">    gN = gp * gq</span><br><span class="line">    <span class="keyword">return</span> gN, gq, gp</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_x</span>(<span class="params">gq,gp</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> gmc(x,gp) ^ gmc(x,gq) == -<span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_y</span>(<span class="params">gN</span>):</span></span><br><span class="line">    gy_list = []</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(gy_list) != F_LEN:</span><br><span class="line">        ty = getRandomNBitInteger(<span class="number">768</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(ty,gN) == <span class="number">1</span>:</span><br><span class="line">            gy_list.append(ty)</span><br><span class="line">    <span class="keyword">return</span> gy_list</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    flag = <span class="built_in">bin</span>(bytes_to_long(flag))[<span class="number">2</span>:]</span><br><span class="line">    F_LEN = <span class="built_in">len</span>(flag)</span><br><span class="line">    N, q, p = gen_key()</span><br><span class="line">    x = gen_x(q, p)</span><br><span class="line">    y_list = gen_y(N)</span><br><span class="line">    ciphertext = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(F_LEN):</span><br><span class="line">        tc = <span class="built_in">pow</span>(y_list[i],<span class="number">2</span>) * <span class="built_in">pow</span>(x,<span class="built_in">int</span>(flag[i])) % N</span><br><span class="line">        ciphertext.append(tc)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(N) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(F_LEN):</span><br><span class="line">            f.write(<span class="built_in">str</span>(ciphertext[i]) + <span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="脚本："><a href="#脚本：" class="headerlink" title="脚本："></a>脚本：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	n = <span class="built_in">int</span>(f.readline())</span><br><span class="line">	<span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">		cipher = <span class="built_in">int</span>(line)</span><br><span class="line">		<span class="keyword">if</span> jacobi(cipher,n) == -<span class="number">1</span>:</span><br><span class="line">			plaintext += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			plaintext += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">print(long_to_bytes(<span class="built_in">int</span>(plaintext,<span class="number">2</span>)))</span><br></pre></td></tr></table></figure>


<h1 id="3-give-you-d"><a href="#3-give-you-d" class="headerlink" title="3.give you d"></a>3.give you d</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">from libnum import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag1, flag2</span><br><span class="line">p &#x3D; getPrime(1024)</span><br><span class="line">q &#x3D; getPrime(1024)</span><br><span class="line">n &#x3D; p * q</span><br><span class="line">e1 &#x3D; 0x10001</span><br><span class="line">e2 &#x3D; getPrime(10)</span><br><span class="line">m1 &#x3D; s2n(flag1)</span><br><span class="line">m2 &#x3D; s2n(flag2)</span><br><span class="line">c1 &#x3D; pow(m1,e1,n)</span><br><span class="line">c2 &#x3D; pow(m2,e2,n)</span><br><span class="line">d1 &#x3D; invert(e1, (p-1)*(q-1))</span><br><span class="line">print(&quot;d1&#x3D;&quot;,d1)</span><br><span class="line">print(&quot;e1&#x3D;&quot;,e1)</span><br><span class="line">print(&quot;c1&#x3D;&quot;,c1)</span><br><span class="line">print(&quot;e2&#x3D;&quot;,e2)</span><br><span class="line">print(&quot;c2&#x3D;&quot;,c2)</span><br><span class="line">print(&quot;n&#x3D;&quot;,n)</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">d1&#x3D; 9760674595501947732457134417772666654580910784816074596844201976549126705054354532744195920843927665908857588327157473562216170891125640382183269947688729492002810318988357177843006032057493977990230963641128334174799854776285092800882842648831234701775647426821652455794980815493792844613781136370482076703203544329344257671121278311220536853628753281655611599927657825576986012274045522950871733649701341830267140818846021723900182040299335787072434827472099558123219735224115651119369318334014106111016265076954167859616248128341257846831841124963643146233831386180209364959204819225771569971911306452163266250257</span><br><span class="line">e1&#x3D; 65537</span><br><span class="line">c1&#x3D; 3031544832428623963829906203623666284826018126199675444023110501554085620562976921090566814311982177229076467389126296690887508093409644544972677863798265638151530384969210400494640484499273950795927369791039457791939011939112692503358690615659156690833216424157047559547652680167891276098046663088364517155401153590589041194382962115823941265534326403568233361880237227171213594784532894464467801044463414691777180394710594840327220694687433155323278247440513979172779693066168556516883948734483230577736355223376127267320269806380149257745585678220927864789251997620899712591359197840818646408155483090462327378317</span><br><span class="line">e2&#x3D; 727</span><br><span class="line">c2&#x3D; 8250074060227424392167527480278910311544463644939163863769800244251691098015162856236070604894987171336652702639307688862569950283687840934874010961725585832492731862924434685764812548041942932991437304133383574739841020490451401245854993454773753547866987060882966503717524737256677223747928372221303252718695826435001757305710227632289961692972038030904412656632501968027338817269883309383732475572755488896637328455512190203818917772932072670066152200777928816271099465751840664067526661763508166046612541288397476570710909799201617460030087141733073112323853659638000871425108472297885477189405403650284325277579</span><br><span class="line">n&#x3D; 16949347684624444199730882020549727207579797835364486390222263981799637446520951564941479241788730755429607052441560089686202304965202328865879149004045368822166561031121061030823165425477649845937992280653629411960834585264656371767877344497402099272681450025479203969037271341644808077619919300874706124928010632466743721206172988706126276081105311610156444961489929845956521779517683260317442382177867528340690129611191602929151767062963900466581680747022376748730840902068954788887770543814815800099455381548242834877925303848347612497301376626619324115990787052927789981745597417645251872764332317707438924093033</span><br><span class="line">&#39;&#39;&#39;</span><br></pre></td></tr></table></figure>
<h2 id="脚本：-1"><a href="#脚本：-1" class="headerlink" title="脚本："></a>脚本：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getpq</span>(<span class="params">n, e, d</span>):</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		k = e * d - <span class="number">1</span></span><br><span class="line">		g = randint(<span class="number">0</span>, n)</span><br><span class="line">		<span class="keyword">while</span> k % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">			k = k // <span class="number">2</span></span><br><span class="line">			temp = <span class="built_in">pow</span>(g, k, n) - <span class="number">1</span></span><br><span class="line">			<span class="keyword">if</span> GCD(temp, n) &gt; <span class="number">1</span> <span class="keyword">and</span> temp != <span class="number">0</span>:</span><br><span class="line">				<span class="keyword">return</span> GCD(temp, n)</span><br><span class="line">d1= <span class="number">9760674595501947732457134417772666654580910784816074596844201976549126705054354532744195920843927665908857588327157473562216170891125640382183269947688729492002810318988357177843006032057493977990230963641128334174799854776285092800882842648831234701775647426821652455794980815493792844613781136370482076703203544329344257671121278311220536853628753281655611599927657825576986012274045522950871733649701341830267140818846021723900182040299335787072434827472099558123219735224115651119369318334014106111016265076954167859616248128341257846831841124963643146233831386180209364959204819225771569971911306452163266250257</span></span><br><span class="line">e1= <span class="number">65537</span></span><br><span class="line">c1= <span class="number">3031544832428623963829906203623666284826018126199675444023110501554085620562976921090566814311982177229076467389126296690887508093409644544972677863798265638151530384969210400494640484499273950795927369791039457791939011939112692503358690615659156690833216424157047559547652680167891276098046663088364517155401153590589041194382962115823941265534326403568233361880237227171213594784532894464467801044463414691777180394710594840327220694687433155323278247440513979172779693066168556516883948734483230577736355223376127267320269806380149257745585678220927864789251997620899712591359197840818646408155483090462327378317</span></span><br><span class="line">e2= <span class="number">727</span></span><br><span class="line">c2= <span class="number">8250074060227424392167527480278910311544463644939163863769800244251691098015162856236070604894987171336652702639307688862569950283687840934874010961725585832492731862924434685764812548041942932991437304133383574739841020490451401245854993454773753547866987060882966503717524737256677223747928372221303252718695826435001757305710227632289961692972038030904412656632501968027338817269883309383732475572755488896637328455512190203818917772932072670066152200777928816271099465751840664067526661763508166046612541288397476570710909799201617460030087141733073112323853659638000871425108472297885477189405403650284325277579</span></span><br><span class="line">n= <span class="number">16949347684624444199730882020549727207579797835364486390222263981799637446520951564941479241788730755429607052441560089686202304965202328865879149004045368822166561031121061030823165425477649845937992280653629411960834585264656371767877344497402099272681450025479203969037271341644808077619919300874706124928010632466743721206172988706126276081105311610156444961489929845956521779517683260317442382177867528340690129611191602929151767062963900466581680747022376748730840902068954788887770543814815800099455381548242834877925303848347612497301376626619324115990787052927789981745597417645251872764332317707438924093033</span></span><br><span class="line">p = getpq(n, e1, d1)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d2 = inverse(e2, phi)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, d1, n)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, d2, n)</span><br><span class="line">print(n2s(m1)+n2s(m2))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;F4ct0r1n9_N_G1v3n_D&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2021/02/25/ACTF-CRYPTO-WP/" class="prev">PREV</a><a href="/2021/02/24/2021-hgame-Crypto%E6%B1%87%E6%80%BB/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 刷题篇(二)Cryptohack-GENERAL · H-Lither</title><meta name="description" content="刷题篇(二)Cryptohack-GENERAL - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">刷题篇(二)Cryptohack-GENERAL</h1><div class="post-info">Feb 17, 2021</div><div class="post-content"><p>-平台规定不能明文发布flag，故只留思路，脚本，以便以后复习。</p>
<h1 id="ENCODING"><a href="#ENCODING" class="headerlink" title="ENCODING"></a>ENCODING</h1><h2 id="1-ASCII"><a href="#1-ASCII" class="headerlink" title="1.ASCII"></a>1.ASCII</h2><p>题目描述：</p>
<blockquote>
<p>ASCII is a 7-bit encoding standard which allows the representation of text using the integers 0-127.</p>
<p>Using the below integer array, convert the numbers to their corresponding ASCII characters to obtain a flag.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116, 52, 98, 108, 51, 125]</span><br></pre></td></tr></table></figure>
<p>脚本：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s=[<span class="number">99</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">112</span>, <span class="number">116</span>, <span class="number">111</span>, <span class="number">123</span>, <span class="number">65</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">73</span>, <span class="number">73</span>, <span class="number">95</span>, <span class="number">112</span>, <span class="number">114</span>, <span class="number">49</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">52</span>, <span class="number">98</span>, <span class="number">108</span>, <span class="number">51</span>, <span class="number">125</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(s[i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h2 id="2-Hex"><a href="#2-Hex" class="headerlink" title="2.Hex"></a>2.Hex</h2><blockquote>
<p>When we encrypt something the resulting ciphertext commonly has bytes which are not printable ASCII characters. If we want to share our encrypted data, it’s common to encode it into something more user-friendly and portable across different systems.</p>
<p>Included below is a the flag encoded as a hex string. Decode this back into bytes to get the flag.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">63727970746f7b596f755f77696c6c5f62655f776f726b696e675f776974685f6865785f737472696e67735f615f6c6f747d</span><br></pre></td></tr></table></figure>
<p>脚本</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">print(long_to_bytes(<span class="number">0x63727970746f7b596f755f77696c6c5f62655f776f726b696e675f776974685f6865785f737472696e67735f615f6c6f747d</span>))</span><br></pre></td></tr></table></figure>
<h2 id="3-Base64"><a href="#3-Base64" class="headerlink" title="3.Base64"></a>3.Base64</h2><blockquote>
<p>Another common encoding scheme is Base64, which allows us to represent binary data as an ASCII string using 64 characters. One character of a Base64 string encodes 6 bits, and so 4 characters of Base64 encodes three 8-bit bytes.</p>
<p>Base64 is most commonly used online, where binary data such as images can be easy included into html or css files.</p>
<p>Take the below hex string, decode it into bytes and then encode it into Base64.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf</span><br></pre></td></tr></table></figure>
<p>脚本</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s=long_to_bytes(<span class="number">0x72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf</span>)</span><br><span class="line">print(base64.b64encode(s))</span><br></pre></td></tr></table></figure>
<h2 id="4-Bytes-and-Big-Integers"><a href="#4-Bytes-and-Big-Integers" class="headerlink" title="4.Bytes and Big Integers"></a>4.Bytes and Big Integers</h2><blockquote>
<p>Convert the following integer back into a message:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">11515195063862318899931685488813747395775516287289682636499965282714637259206269</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s&#x3D;long_to_bytes(11515195063862318899931685488813747395775516287289682636499965282714637259206269)</span><br></pre></td></tr></table></figure>
<h2 id="5-Encoding-Challenge"><a href="#5-Encoding-Challenge" class="headerlink" title="5.Encoding Challenge"></a>5.Encoding Challenge</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">r = remote(<span class="string">&#x27;socket.cryptohack.org&#x27;</span>, <span class="number">13377</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">json_recv</span>():</span></span><br><span class="line">    line = r.recvline()</span><br><span class="line">    <span class="keyword">return</span> json.loads(line.decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">json_send</span>(<span class="params">hsh</span>):</span></span><br><span class="line">    request = json.dumps(hsh).encode()</span><br><span class="line">    r.sendline(request)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">challenge_words = []  <span class="comment"># 建立接收数据的列表</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    received = json_recv()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print(&quot;Received type: &quot;)</span></span><br><span class="line">    <span class="comment"># print(received[&quot;type&quot;])</span></span><br><span class="line">    <span class="comment"># print(&quot;Received encoded value: &quot;)</span></span><br><span class="line">    <span class="comment"># print(received[&quot;encoded&quot;])</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> received[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;base64&quot;</span>:  <span class="comment"># 根据编码类型解码加入到列表中</span></span><br><span class="line">        challenge_words.append(base64.b64decode(received[<span class="string">&quot;encoded&quot;</span>].encode()).decode())  <span class="comment"># wow so encode</span></span><br><span class="line">    <span class="keyword">elif</span> received[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">        challenge_words.append(unhexlify(received[<span class="string">&quot;encoded&quot;</span>]).decode())</span><br><span class="line">    <span class="keyword">elif</span> received[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;rot13&quot;</span>:</span><br><span class="line">        challenge_words.append(codecs.decode(received[<span class="string">&quot;encoded&quot;</span>], <span class="string">&#x27;rot_13&#x27;</span>))</span><br><span class="line">    <span class="keyword">elif</span> received[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;bigint&quot;</span>:</span><br><span class="line">        challenge_words.append(long_to_bytes(<span class="built_in">int</span>(received[<span class="string">&quot;encoded&quot;</span>], <span class="number">16</span>)).decode())</span><br><span class="line">    <span class="keyword">elif</span> received[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;utf-8&quot;</span>:</span><br><span class="line">        challenge_words.append(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> received[<span class="string">&quot;encoded&quot;</span>]))</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;%d : %s&quot;</span> % (i, challenge_words[i]))  <span class="comment"># 打印出本次要发送到服务端的值</span></span><br><span class="line"></span><br><span class="line">    to_send = &#123;</span><br><span class="line">        <span class="string">&quot;decoded&quot;</span>: challenge_words[i]</span><br><span class="line">    &#125;</span><br><span class="line">    json_send(to_send)</span><br><span class="line"></span><br><span class="line">received = json_recv()  <span class="comment"># 接收flag数据</span></span><br><span class="line"></span><br><span class="line">print(received[<span class="string">&quot;flag&quot;</span>])</span><br></pre></td></tr></table></figure>
<h1 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h1><h2 id="1-XOR-Starter"><a href="#1-XOR-Starter" class="headerlink" title="1.XOR Starter"></a>1.XOR Starter</h2><blockquote>
<p>Given the string <code>&quot;label&quot;</code>, XOR each character with the integer <code>13</code>. Convert these integers back to a string and submit the flag as <code>crypto&#123;new_string&#125;</code>.</p>
</blockquote>
<p>脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">o&#x3D;&#39;label&#39;</span><br><span class="line">flag&#x3D;&#39;&#39;</span><br><span class="line">for i in range(len(o)):</span><br><span class="line">    flag+&#x3D;chr(ord(o[i])^13)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h2 id="2-XOR-Properties"><a href="#2-XOR-Properties" class="headerlink" title="2.XOR Properties"></a>2.XOR Properties</h2><blockquote>
<p>KEY1 = a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313<br>KEY2 ^ KEY1 = 37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e<br>KEY2 ^ KEY3 = c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1<br>FLAG ^ KEY1 ^ KEY3 ^ KEY2 = 04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf</p>
</blockquote>
<p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">KEY1 = <span class="number">0xa6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313</span></span><br><span class="line">KEY2 = <span class="number">233131678106482661238672080114331736309154844705032145066618125</span></span><br><span class="line"></span><br><span class="line">KEY3 = <span class="number">0xc1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1</span>^KEY2</span><br><span class="line">FLAG= <span class="number">0x04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf</span>^KEY2^KEY3^KEY1</span><br><span class="line">print(long_to_bytes(FLAG))</span><br></pre></td></tr></table></figure>
<h2 id="3-Favourite-byte"><a href="#3-Favourite-byte" class="headerlink" title="3.Favourite byte"></a>3.Favourite byte</h2><blockquote>
<p>I’ve hidden my data using XOR with a single byte. Don’t forget to decode from hex first.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">print(long_to_bytes(<span class="number">0x73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d</span>))</span><br><span class="line"></span><br><span class="line">s=<span class="string">&quot;sbi`d\x7fk h! O!%O&#125;iOv$f eb!&#x27;#Ori&#x27;um&quot;</span></span><br><span class="line"><span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">        flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[i])^o)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;crypto&#x27;</span> <span class="keyword">in</span> flag :</span><br><span class="line"></span><br><span class="line">        print(o)</span><br><span class="line">        print(flag)</span><br></pre></td></tr></table></figure>
<h2 id="4-You-either-know-XOR-you-don’t"><a href="#4-You-either-know-XOR-you-don’t" class="headerlink" title="4.You either know, XOR you don’t"></a>4.You either know, XOR you don’t</h2><blockquote>
<p>I’ve encrypted the flag with my secret key, you’ll never be able to guess it.</p>
<p>Remember the flag format and how it might help you in this challenge!</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150104</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150104&#x27;</span></span><br><span class="line">decoded_data = <span class="built_in">bytes</span>.fromhex(data)</span><br><span class="line"><span class="comment"># print(decoded_data)</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;crypto&#123;&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;&#x27;</span>.join((<span class="built_in">chr</span>(decoded_data[i] ^ <span class="built_in">ord</span>(<span class="built_in">str</span>[i]))) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>))</span><br><span class="line">key = key + <span class="string">&#x27;y&#x27;</span></span><br><span class="line"><span class="comment"># print(key)</span></span><br><span class="line">flag = xor(decoded_data, key.encode())  <span class="comment"># xor函数自动将key匹配为与密文长度一致进行异或解密</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h2 id="5-Lemur-XOR"><a href="#5-Lemur-XOR" class="headerlink" title="5.Lemur XOR"></a>5.Lemur XOR</h2><p>用misc的工具，两张图异或就行。</p>
<h1 id="MATHEMATICS"><a href="#MATHEMATICS" class="headerlink" title="MATHEMATICS"></a>MATHEMATICS</h1><h2 id="1-Greatest-Common-Divisor"><a href="#1-Greatest-Common-Divisor" class="headerlink" title="1.Greatest Common Divisor"></a>1.Greatest Common Divisor</h2><blockquote>
<p>There are many tools to calculate the GCD of two integers, but for this task we recommend looking up <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Euclidean_algorithm">Euclid’s Algorithm</a>.</p>
<p>Try coding it up; it’s only a couple of lines. Use <code>a = 12, b = 8</code> to test it.</p>
<p>Now calculate <code>gcd(a,b)</code> for <code>a = 66528, b = 52920</code> and enter it below.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a &#x3D; 66528</span><br><span class="line">b &#x3D; 52920</span><br><span class="line">print(gcd(a,b))</span><br></pre></td></tr></table></figure>
<h2 id="2-Extended-GCD"><a href="#2-Extended-GCD" class="headerlink" title="2.Extended GCD"></a>2.Extended GCD</h2><p>ing</p>
<h2 id="3-Modular-Arithmetic-1"><a href="#3-Modular-Arithmetic-1" class="headerlink" title="3.Modular Arithmetic 1"></a>3.Modular Arithmetic 1</h2><blockquote>
<p>Calculate the following integers:</p>
<p>11 ≡ a mod 6<br>8146798528947 ≡ b mod 17</p>
<p>The solution is the smaller of the two integers.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a&#x3D;11%6</span><br><span class="line">b&#x3D;8146798528947%17</span><br></pre></td></tr></table></figure>
<h2 id="4-Modular-Arithmetic-2"><a href="#4-Modular-Arithmetic-2" class="headerlink" title="4.Modular Arithmetic 2"></a>4.Modular Arithmetic 2</h2><blockquote>
<p>Now take the prime <code>p = 65537</code>. Calculate <code>273246787654^65536 mod 65537</code>.</p>
<p>Did you need a calculator?</p>
</blockquote>
<p>费马小定理可知，</p>
<h2 id="5-Modular-Inverting"><a href="#5-Modular-Inverting" class="headerlink" title="5.Modular Inverting"></a>5.Modular Inverting</h2><blockquote>
<p><strong>Example</strong>: <code>7 * 8 = 56 ≡ 1 mod 11</code></p>
<p>What is the inverse element: <code>3 * d ≡ 1 mod 13</code>?</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d=invert(<span class="number">3</span>,<span class="number">13</span>)<span class="comment">#gmpy2</span></span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2021/02/17/%E5%88%B7%E9%A2%98%E7%AF%87-%E4%B8%89-Cryptohack-RSA/" class="prev">PREV</a><a href="/2021/02/16/%E5%88%B7%E9%A2%98%E7%AF%87(%E4%B8%80%EF%BC%89picoCTF-Crypto/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 刷题篇(三)Cryptohack-RSA · H-Lither</title><meta name="description" content="刷题篇(三)Cryptohack-RSA - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">刷题篇(三)Cryptohack-RSA</h1><div class="post-info">Feb 17, 2021</div><div class="post-content"><h1 id="STARTER"><a href="#STARTER" class="headerlink" title="STARTER"></a>STARTER</h1><h2 id="1-RSA-Starter-1"><a href="#1-RSA-Starter-1" class="headerlink" title="1.RSA Starter 1"></a>1.RSA Starter 1</h2><h2 id="2-RSA-Starter-2"><a href="#2-RSA-Starter-2" class="headerlink" title="2.RSA Starter 2"></a>2.RSA Starter 2</h2><h2 id="3-RSA-Starter-3"><a href="#3-RSA-Starter-3" class="headerlink" title="3.RSA Starter 3"></a>3.RSA Starter 3</h2><h2 id="4-RSA-Starter-4"><a href="#4-RSA-Starter-4" class="headerlink" title="4.RSA Starter 4"></a>4.RSA Starter 4</h2><h2 id="5-RSA-Starter-5"><a href="#5-RSA-Starter-5" class="headerlink" title="5.RSA Starter 5"></a>5.RSA Starter 5</h2><h2 id="6-RSA-Starter-6"><a href="#6-RSA-Starter-6" class="headerlink" title="6.RSA Starter 6"></a>6.RSA Starter 6</h2><p>前面六道入门题略。。。。。</p>
<h1 id="PRIMES-PART-1"><a href="#PRIMES-PART-1" class="headerlink" title="PRIMES PART 1"></a>PRIMES PART 1</h1><h2 id="1-Factoring"><a href="#1-Factoring" class="headerlink" title="1.Factoring"></a>1.Factoring</h2><blockquote>
<p>Factorise the 150-bit number <code>510143758735509025530880200653196460532653147</code> into its two constituent primes. Give the smaller one as your answer.</p>
</blockquote>
<p>直接在线网站分解或者sagemath使用factor()分解</p>
<h2 id="2-Inferius-Prime"><a href="#2-Inferius-Prime" class="headerlink" title="2.Inferius Prime"></a>2.Inferius Prime</h2><p>分解n，然后常规的rsa解题套路。</p>
<h2 id="3-Monoprime"><a href="#3-Monoprime" class="headerlink" title="3.Monoprime"></a>3.Monoprime</h2><p>题目提示单个质数</p>
<blockquote>
<p>Why is everyone so obsessed with multiplying two primes for RSA. Why not just use one?</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="comment">#</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="comment">#</span></span><br><span class="line">phi=(n-<span class="number">1</span>)</span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="4-Square-Eyes"><a href="#4-Square-Eyes" class="headerlink" title="4.Square Eyes"></a>4.Square Eyes</h2><blockquote>
<p>It was taking forever to get a 2048 bit prime, so I just generated one and used it twice.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="comment">#</span></span><br><span class="line">p=<span class="comment">#</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="comment">#</span></span><br><span class="line">phi=p*(p-<span class="number">1</span>)</span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="5-Manyprime"><a href="#5-Manyprime" class="headerlink" title="5.Manyprime"></a>5.Manyprime</h2><blockquote>
<p>Using one prime factor was definitely a bad idea so I’ll try using over 30 instead.</p>
</blockquote>
<p>factor在线网站分解。欧拉函数值用脚本跑出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">q=[<span class="number">9282105380008121879</span>,</span><br><span class="line"><span class="number">9303850685953812323</span>,</span><br><span class="line"><span class="number">9389357739583927789</span>,</span><br><span class="line"><span class="number">10336650220878499841</span>,</span><br><span class="line"><span class="number">10638241655447339831</span>,</span><br><span class="line"><span class="number">11282698189561966721</span>,</span><br><span class="line"><span class="number">11328768673634243077</span>,</span><br><span class="line"><span class="number">11403460639036243901</span>,</span><br><span class="line"><span class="number">11473665579512371723</span>,</span><br><span class="line"><span class="number">11492065299277279799</span>,</span><br><span class="line"><span class="number">11530534813954192171</span>,</span><br><span class="line"><span class="number">11665347949879312361</span>,</span><br><span class="line"><span class="number">12132158321859677597</span>,</span><br><span class="line"><span class="number">12834461276877415051</span>,</span><br><span class="line"><span class="number">12955403765595949597</span>,</span><br><span class="line"><span class="number">12973972336777979701</span>,</span><br><span class="line"><span class="number">13099895578757581201</span>,</span><br><span class="line"><span class="number">13572286589428162097</span>,</span><br><span class="line"><span class="number">14100640260554622013</span>,</span><br><span class="line"><span class="number">14178869592193599187</span>,</span><br><span class="line"><span class="number">14278240802299816541</span>,</span><br><span class="line"><span class="number">14523070016044624039</span>,</span><br><span class="line"><span class="number">14963354250199553339</span>,</span><br><span class="line"><span class="number">15364597561881860737</span>,</span><br><span class="line"><span class="number">15669758663523555763</span>,</span><br><span class="line"><span class="number">15824122791679574573</span>,</span><br><span class="line"><span class="number">15998365463074268941</span>,</span><br><span class="line"><span class="number">16656402470578844539</span>,</span><br><span class="line"><span class="number">16898740504023346457</span>,</span><br><span class="line"><span class="number">17138336856793050757</span>,</span><br><span class="line"><span class="number">17174065872156629921</span>,</span><br><span class="line"><span class="number">17281246625998849649</span>]</span><br><span class="line">phi=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(q)):</span><br><span class="line">    phi*=(q[i]-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">580642391898843192929563856870897799650883152718761762932292482252152591279871421569162037190419036435041797739880389529593674485555792234900969402019055601781662044515999210032698275981631376651117318677368742867687180140048715627160641771118040372573575479330830092989800730105573700557717146251860588802509310534792310748898504394966263819959963273509119791037525504422606634640173277598774814099540555569257179715908642917355365791447508751401889724095964924513196281345665480688029639999472649549163147599540142367575413885729653166517595719991872223011969856259344396899748662101941230745601719730556631637</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">320721490534624434149993723527322977960556510750628354856260732098109692581338409999983376131354918370047625150454728718467998870322344980985635149656977787964380651868131740312053755501594999166365821315043312308622388016666802478485476059625888033017198083472976011719998333985531756978678758897472845358167730221506573817798467100023754709109274265835201757369829744113233607359526441007577850111228850004361838028842815813724076511058179239339760639518034583306154826603816927757236549096339501503316601078891287408682099750164720032975016814187899399273719181407940397071512493967454225665490162619270814464</span></span><br><span class="line"></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h1 id="PUBLIC-EXPONENT"><a href="#PUBLIC-EXPONENT" class="headerlink" title="PUBLIC EXPONENT"></a>PUBLIC EXPONENT</h1><h2 id="1-Salty"><a href="#1-Salty" class="headerlink" title="1.Salty"></a>1.Salty</h2><blockquote>
<p>Smallest exponent should be fastest, right?</p>
</blockquote>
<p>e=1。且n&gt;c。直接解密即可。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(long_to_bytes(c))</span><br></pre></td></tr></table></figure>
<h2 id="2-Modulus-Inutilis"><a href="#2-Modulus-Inutilis" class="headerlink" title="2.Modulus Inutilis"></a>2.Modulus Inutilis</h2><blockquote>
<p>My primes should be more than large enough now!</p>
</blockquote>
<p>e=3且n&gt;&gt;c,直接开方即可或者低加密质数攻击。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n &#x3D; #</span><br><span class="line">e &#x3D; 3</span><br><span class="line">c &#x3D; #</span><br><span class="line"># phi&#x3D;</span><br><span class="line"># d&#x3D;invert(e,phi)</span><br><span class="line"># m&#x3D;pow(c,d,n)</span><br><span class="line">m&#x3D;iroot(c,e)[0]</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="3-Everything-is-Big"><a href="#3-Everything-is-Big" class="headerlink" title="3.Everything is Big"></a>3.Everything is Big</h2><blockquote>
<p>I asked my friends to encrypt our secret flag before sending it to me, but instead of using my key, they’ve all used their own! Can you help?</p>
</blockquote>
<p>重复套娃即可</p>
<h2 id="4-Everything-is-Still-Big"><a href="#4-Everything-is-Still-Big" class="headerlink" title="4.Everything is Still Big"></a>4.Everything is Still Big</h2><p>根据源码可知<img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/fa302cb878c813c00cd5148afd2b7030.svg" alt="img">。</p>
<p>使用Boneh and Durfee attack求得d然后就是常规解密</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d&#x3D;11780471238670051178036100291599528752121010273742795983048162524067159920858226567772845036827236538829687625029129242589458595768537819428280893758899509</span><br></pre></td></tr></table></figure>
<h2 id="5-Endless-Emails"><a href="#5-Endless-Emails" class="headerlink" title="5.Endless Emails"></a>5.Endless Emails</h2><p>低指数广播攻击。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"></span><br><span class="line">resp = requests.get(<span class="string">&#x27;https://cryptohack.org/static/challenges/output_0ef6d6343784e59e2f44f61d2d29896f.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">lines = resp.text.splitlines()</span><br><span class="line"></span><br><span class="line">params = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lines), <span class="number">5</span>):</span><br><span class="line">    n = <span class="built_in">int</span>(lines[i].split(<span class="string">&#x27; &#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">    e = <span class="built_in">int</span>(lines[i+<span class="number">1</span>].split(<span class="string">&#x27; &#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">    c = <span class="built_in">int</span>(lines[i+<span class="number">2</span>].split(<span class="string">&#x27; &#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">    params.append([n, c])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">ns, cs</span>):</span></span><br><span class="line">    M = reduce(operator.mul, ns)</span><br><span class="line">    Mi = [M//n <span class="keyword">for</span> n <span class="keyword">in</span> ns]</span><br><span class="line">    ti = [<span class="built_in">pow</span>(Mi, -<span class="number">1</span>, n) <span class="keyword">for</span> Mi, n <span class="keyword">in</span> <span class="built_in">zip</span>(Mi, ns)]</span><br><span class="line">    x = <span class="built_in">sum</span>([c*t*m <span class="keyword">for</span> c, t, m <span class="keyword">in</span> <span class="built_in">zip</span>(cs, ti, Mi)]) % M</span><br><span class="line">    r, exact = gmpy2.iroot(x, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">if</span> exact:</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> cb <span class="keyword">in</span> combinations(params, <span class="number">3</span>):</span><br><span class="line">    ns = [x[<span class="number">0</span>] <span class="keyword">for</span> x <span class="keyword">in</span> cb]</span><br><span class="line">    cs = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> cb]</span><br><span class="line">    r = solve(ns, cs)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    print(number.long_to_bytes(r))</span><br></pre></td></tr></table></figure>
<h1 id="PRIMES-PART-2"><a href="#PRIMES-PART-2" class="headerlink" title="PRIMES PART 2"></a>PRIMES PART 2</h1><h2 id="1-Infinite-Descent"><a href="#1-Infinite-Descent" class="headerlink" title="1.Infinite Descent"></a>1.Infinite Descent</h2><p>常规题，factor在线网站能直接分解n。</p>
<h2 id="2-Marin’s-Secrets"><a href="#2-Marin’s-Secrets" class="headerlink" title="2.Marin’s Secrets"></a>2.Marin’s Secrets</h2><p>常规题，factor在线网站能直接分解n。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2021/02/17/2021-hgame-week2-Crypto/" class="prev">PREV</a><a href="/2021/02/17/%E5%88%B7%E9%A2%98%E7%AF%87-%E4%BA%8C-Cryptohack-GENERAL/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>
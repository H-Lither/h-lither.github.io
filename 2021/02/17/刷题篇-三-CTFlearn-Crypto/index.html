<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 刷题篇(四)CTFlearn-Crypto · H-Lither</title><meta name="description" content="刷题篇(四)CTFlearn-Crypto - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">刷题篇(四)CTFlearn-Crypto</h1><div class="post-info">Feb 17, 2021</div><div class="post-content"><p>-</p>
<h2 id="1-Character-Encoding"><a href="#1-Character-Encoding" class="headerlink" title="1.Character Encoding"></a>1.Character Encoding</h2><p>十六进制转字符</p>
<h2 id="2-Base-2-2-the-6"><a href="#2-Base-2-2-the-6" class="headerlink" title="2.Base 2 2 the 6"></a>2.Base 2 2 the 6</h2><p>base64解码</p>
<h2 id="3-Morse-Code"><a href="#3-Morse-Code" class="headerlink" title="3.Morse Code"></a>3.Morse Code</h2><p>莫斯解码</p>
<h2 id="4-Hextroadinary"><a href="#4-Hextroadinary" class="headerlink" title="4.Hextroadinary"></a>4.Hextroadinary</h2><p>两个数异或即可</p>
<h2 id="5-Reverse-Polarity"><a href="#5-Reverse-Polarity" class="headerlink" title="5.Reverse Polarity"></a>5.Reverse Polarity</h2><p>转成整形然后long_to_bytes即可</p>
<h2 id="6-Vigenere-Cipher"><a href="#6-Vigenere-Cipher" class="headerlink" title="6.Vigenere Cipher"></a>6.Vigenere Cipher</h2><p>维吉尼亚解密即可，已知密钥和密文。</p>
<h2 id="7-BruXOR"><a href="#7-BruXOR" class="headerlink" title="7.BruXOR"></a>7.BruXOR</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">d=<span class="string">&quot;q&#123;vpln&#x27;bH_varHuebcrqxetrHOXEj&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d)):</span><br><span class="line">        flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(d[i])^k)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        print(<span class="string">&#x27;key = &#x27;</span>+<span class="built_in">str</span>(k)+<span class="string">&#x27;\n&#x27;</span>+flag)</span><br><span class="line">        exit()</span><br></pre></td></tr></table></figure>
<h2 id="8-HyperStream-Test-2"><a href="#8-HyperStream-Test-2" class="headerlink" title="8.HyperStream Test #2"></a>8.HyperStream Test #2</h2><p>使用CyberChef进行培根解密</p>
<h2 id="9-Substitution-Cipher"><a href="#9-Substitution-Cipher" class="headerlink" title="9.Substitution Cipher"></a>9.Substitution Cipher</h2><p>词频分析，使用<a target="_blank" rel="noopener" href="http://quipqiup.com/">网站</a></p>
<h2 id="10-rsanoob"><a href="#10-rsanoob" class="headerlink" title="10.rsanoob"></a>10.rsanoob</h2><p>e=1</p>
<p>n&gt;c</p>
<p>所以c=m</p>
<p>直接解密c就行了。</p>
<h2 id="11-So-many-64s"><a href="#11-So-many-64s" class="headerlink" title="11.So many 64s"></a>11.So many 64s</h2><p>base64重复套娃</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    f=b64decode(d)</span><br><span class="line">    d=f</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;&#123;&#x27;</span> <span class="keyword">in</span> d:</span><br><span class="line">        print(d)</span><br><span class="line">        exit()</span><br></pre></td></tr></table></figure>


<h2 id="12-5x5-Crypto"><a href="#12-5x5-Crypto" class="headerlink" title="12. 5x5 Crypto"></a>12. 5x5 Crypto</h2><blockquote>
<p>Try: 1-3,4-4,2-1,{,4-4,2-3,4-5,3-2,1-2,4-3,_,4-5,3-5,}</p>
</blockquote>
<p> Polybius 密码</p>
<p>对着表解密即可，左边是行，右边是列</p>
<h2 id="13-RSA-Beginner"><a href="#13-RSA-Beginner" class="headerlink" title="13.RSA Beginner"></a>13.RSA Beginner</h2><p>常规rsa题，分解n，然后一把梭</p>
<h2 id="14-Modern-Gaius-Julius-Caesar"><a href="#14-Modern-Gaius-Julius-Caesar" class="headerlink" title="14.Modern Gaius Julius Caesar"></a>14.Modern Gaius Julius Caesar</h2><blockquote>
<p>One of the easiest and earliest known ciphers but with XXI century twist! Nobody uses Alphabet nowadays right? Why should you when you have your keyboard?</p>
<p>BUH’tdy,|Bim5y~Bdt76yQ</p>
</blockquote>
<p>每个值，在键盘上左移两位即为flag</p>
<h2 id="15-RSA-Twins"><a href="#15-RSA-Twins" class="headerlink" title="15.RSA Twins!"></a>15.RSA Twins!</h2><p>直接分解n，然后常规rsa解密</p>
<h2 id="16-CoppeRSA-Lattice"><a href="#16-CoppeRSA-Lattice" class="headerlink" title="16.CoppeRSA Lattice"></a>16.CoppeRSA Lattice</h2><p>直接分解n即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e&#x3D; 65537</span><br><span class="line">c&#x3D;#</span><br><span class="line">n&#x3D; #</span><br><span class="line">p&#x3D;#</span><br><span class="line">q&#x3D;#</span><br><span class="line">phi&#x3D;(p-1)*(q-1)</span><br><span class="line">d&#x3D;inverse(e,phi)</span><br><span class="line">m&#x3D;pow(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="17-Encryption-Master"><a href="#17-Encryption-Master" class="headerlink" title="17.Encryption Master"></a>17.Encryption Master</h2><p>base64+hex+bin 套娃.</p>
<h2 id="18-Symbolic-Decimals"><a href="#18-Symbolic-Decimals" class="headerlink" title="18.Symbolic Decimals"></a>18.Symbolic Decimals</h2><blockquote>
<p>Did you know that you can hide messages with symbols? For example, <code>!@#$%^&amp;*(</code> is <code>123456789!</code><br /> Now Try: <code>^&amp;,*$,&amp;),!@#,*#,!!^,(&amp;,!!$,(%,$^,(%,*&amp;,(&amp;,!!$,!!%,(%,$^,(%,&amp;),!!!,!!$,(%,$^,(%,&amp;^,!)%,!)@,!)!,!@%</code> However, this isn’t as easy as you might think.</p>
</blockquote>
<p>注意)=0</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">o=<span class="string">&quot;^&amp;,*$,&amp;),!@#,*#,!!^,(&amp;,!!$,(%,$^,(%,*&amp;,(&amp;,!!$,!!%,(%,$^,(%,&amp;),!!!,!!$,(%,$^,(%,&amp;^,!)%,!)@,!)!,!@%&quot;</span></span><br><span class="line">o1=o.replace(<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">o2=o1.replace(<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">o3=o2.replace(<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">o4=o3.replace(<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">o5=o4.replace(<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">o6=o5.replace(<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;6&#x27;</span>)</span><br><span class="line">o7=o6.replace(<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;7&#x27;</span>)</span><br><span class="line">o8=o7.replace(<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;8&#x27;</span>)</span><br><span class="line">o9=o8.replace(<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">o=o9.replace(<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">print(o)</span><br><span class="line">w=[<span class="number">67</span>,<span class="number">84</span>,<span class="number">70</span>,<span class="number">123</span>,<span class="number">83</span>,<span class="number">116</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">95</span>,<span class="number">46</span>,<span class="number">95</span>,<span class="number">87</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">115</span>,<span class="number">95</span>,<span class="number">46</span>,<span class="number">95</span>,<span class="number">70</span>,<span class="number">111</span>,<span class="number">114</span>,<span class="number">95</span>,<span class="number">46</span>,<span class="number">95</span>,<span class="number">76</span>,<span class="number">105</span>,<span class="number">102</span>,<span class="number">101</span>,<span class="number">125</span></span><br><span class="line">]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(w)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(w[i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h2 id="19-Suspecious-message"><a href="#19-Suspecious-message" class="headerlink" title="19.Suspecious message"></a>19.Suspecious message</h2><p>Playfair cipher<a target="_blank" rel="noopener" href="https://www.boxentriq.com/code-breaking/playfair-cipher">解密</a>,密钥是图片的字符串</p>
<h2 id="20-Nasty-Little-Doctorses"><a href="#20-Nasty-Little-Doctorses" class="headerlink" title="20.Nasty Little Doctorses!"></a>20.Nasty Little Doctorses!</h2><p>md5解密</p>
<h2 id="21-Skynet-Is-Almost-Taking-Over"><a href="#21-Skynet-Is-Almost-Taking-Over" class="headerlink" title="21.Skynet Is (Almost) Taking Over"></a>21.Skynet Is (Almost) Taking Over</h2><p>低指数广播攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">c1=<span class="number">5024836662627906750454817701922271080214720765897113783786369197810770999608528443597447448508876214100063962982376037712548944474807897847869334582773452689962992522987755069402952836848501053684233233850594080254869</span></span><br><span class="line">n1= <span class="number">10603199174122839808738169357706062732533966731323858892743816728206914395320609331466257631096646511986506501272036007668358071304364156150345138983648630874220488837685118753574424686204595981514561343227316297317899</span></span><br><span class="line"></span><br><span class="line">c2= <span class="number">130884437483098301339042672379318680582507704056215246672305503902799253294397268030727540524911640778691710963573363763216872030631281953772411963153320471648783848323158455504315739311667392161460121273259241311534</span></span><br><span class="line">n2= <span class="number">5613358668671613665566510382994441407219432062998832523305840186970780370368271618683122274081615792349154210168307159475914213081021759597948038689876676892007399580995868266543309872185843728429426430822156211839073</span></span><br><span class="line"></span><br><span class="line">c3=<span class="number">40136988332296795741662524458025734893351353026652568277369126873536130787573840288544348201399567767278683800132245661707440297299339161485942455489387697524794283615358478900857853907316854396647838513117062760230880</span></span><br><span class="line">n3= <span class="number">43197226819995414250880489055413585390503681019180594772781599842207471693041753129885439403306011423063922105541557658194092177558145184151460920732675652134876335722840331008185551706229533179802997366680787866083523</span></span><br><span class="line"></span><br><span class="line">n=[n1,n2,n3]</span><br><span class="line">c=[c1,c2,c3]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">        <span class="keyword">if</span>(i!=j):</span><br><span class="line">            <span class="keyword">if</span>(gmpy2.gcd(n[i],n[j])!=<span class="number">1</span>):   <span class="comment">#对不同的n进行 欧几里得算法，以求出最大公约数(p)</span></span><br><span class="line">                print(i,j)                 <span class="comment">#输出对应的n的序号</span></span><br><span class="line">                p = gmpy2.gcd(n[i],n[j])</span><br><span class="line">                print(<span class="string">&quot;p = &quot;</span>,p)</span><br><span class="line">                q = n[i] // p</span><br><span class="line">                print(<span class="string">&quot;q = &quot;</span>,q)</span><br><span class="line">                d = gmpy2.invert(e , (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">                print(<span class="string">&quot;d = &quot;</span>,d)</span><br><span class="line">                m = <span class="built_in">pow</span>(c[i],d,n[i])</span><br><span class="line">                print(<span class="string">&quot;m = &quot;</span>,m)</span><br></pre></td></tr></table></figure>
<h2 id="22-XOR-Is-Friend-Not-Food"><a href="#22-XOR-Is-Friend-Not-Food" class="headerlink" title="22.XOR Is Friend Not Food"></a>22.XOR Is Friend Not Food</h2><p>给了提示。逐个异或发现，会出现重复，重复部分为  jowls</p>
<p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&quot;\t\x1b\x11\x00\x16\x0b\x1d\x19\x17\x0b\x05\x1d(\x05\x005\x1b\x1f\t,\r\x00\x18\x1c\x0e&quot;</span></span><br><span class="line">key=<span class="string">&#x27;jowls&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[i])^<span class="built_in">ord</span>(key[i%<span class="number">5</span>]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h2 id="23-Tone-dialing"><a href="#23-Tone-dialing" class="headerlink" title="23.Tone dialing"></a>23.Tone dialing</h2><p><a target="_blank" rel="noopener" href="http://dialabc.com/sound/detect/index.html">解密</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;67 84 70 108 101 97 110 123 67 82 89 80 84 79 71 82 65 80 72 89 125&#x27;</span></span><br><span class="line">s = s.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> s:</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(ch))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h2 id="24-Defying-Hell"><a href="#24-Defying-Hell" class="headerlink" title="24.Defying Hell"></a>24.Defying Hell</h2><p>考察DH在乘法群下，求a，b</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p=<span class="comment">#</span></span><br><span class="line">g=<span class="comment">#</span></span><br><span class="line">A=<span class="comment">#</span></span><br><span class="line">B=<span class="comment">#</span></span><br><span class="line">a=discrete_log(mod(A,p),mod(g,p))</span><br><span class="line">print(long_to_bytes(a))b=discrete_log(mod(B,p),mod(g,p))</span><br><span class="line">print(long_to_bytes(b))</span><br></pre></td></tr></table></figure>
<p>ing——–</p>
</div></article></div></main><footer><div class="paginator"><a href="/2021/02/17/2021-hgame-week1-Crypto/" class="prev">PREV</a><a href="/2021/02/17/2021-hgame-week3-Crypto/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>
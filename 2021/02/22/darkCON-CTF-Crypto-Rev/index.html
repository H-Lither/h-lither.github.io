<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> darkCON CTF Crypto&Rev · H-Lither</title><meta name="description" content="darkCON CTF Crypto&amp;Rev - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">darkCON CTF Crypto&Rev</h1><div class="post-info">Feb 22, 2021</div><div class="post-content"><p>-五道密码，三道逆向</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="1-Crypto-Risk-Security-Analyst-Alice-Vs-Eve（21-solves-488-points）"><a href="#1-Crypto-Risk-Security-Analyst-Alice-Vs-Eve（21-solves-488-points）" class="headerlink" title="1.Crypto/Risk Security Analyst Alice Vs Eve（21 solves / 488 points）"></a>1.Crypto/Risk Security Analyst Alice Vs Eve（21 solves / 488 points）</h2><blockquote>
<p>La Casa De Tuple (L.C.D.T) is a Company in Spain which provides their own End-to-end encryption services and Alice got a job there. It was her first day and her boss told her to manage the <strong>secrets</strong> and encrypt the user data with their new End-to-end encryption system. You are Eve and you’re hired to break into the system. Alice was so overconfident that she gave you everyone’s keys. Can you break their new encryption system and read the chats?</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="string">b&#x27;\xa5\x8f\x82\xf08\xeaH&quot;7\x08:\x02^\xa1\x98\x86&lt;^\x86\x8d\xd5o\xcb\x80\xa2+\x83\x8dQ\xf8\xf7\xf6)3\x15J\xa0s\xc6\xea_\xa3\x0c3\x8aB\xee\xee\xbb\xa4\xe7\xe4\xe9\x01P\x18J\x1e-H&gt;\xff1I\xed\xfaN\x08\xcb\x8b3\xeb\x95\x174\xcb\xef\xe9x\xf7\xf9\xa2eV\x89\x80\x1c\x16`\xaf&amp;\x17\xfa,\x95W\x17Oj\xf2\xba\xfb\xb3\xbe\xca\xe1\x16\xccZ\x16:L\xc4\x82\xbe\xc3\xeb,\xefTx\x83\xcd\xdbw\xf7\xe9\xb1&#x27;</span></span><br><span class="line">,<span class="string">b&#x27;d\xd7\xa9i\x1f!I\xed\xbb\x811\x06\xa2\xb7\x9f\xc7\xdf\xb2L\x15\x10\xea~\x94\x85P\xa0U\xf9\x15v\xa2h\xe6\xb2\xfe\x1b\xdd\x01v\x1a\x85\x85\xc5\xd5\x9e&#123;\x9e\x01&amp;Xh$\xc5\xc4\xbb\x15\xb1\x89y\x94\xaa\xbb\x19P\x8a;u\xc6\\$9\n(\xfc\xccC\xb4\xba\x12UZ3\xdd\xaa\xd5\xa5\xc0&#123;a\x1a?\xf5@\xf4\xfb&#125;w\xb7&amp;\xb2\xb1p\x89j\xd1\xc6\xc4g.g\x17j\x13\xde\x17\x0e\n$\xdcg\x02\x90\xc9\xff\x1a\xc9C&#x27;</span></span><br><span class="line">, <span class="string">b&quot;\xab\xa8HX\xc0\xce\x10DLpm(1O\xbfW[\xf4\xfdm*\xc0\xb2\x14\x86\xa0`\x1fd\xdc\x8a\x86\x8f;Y\x16\xe0.\xea;)\xa9k\xff\xb2\x00F\xfaQ\xa4\xb2\xc4&#x27;I\xb3\x84[\xf52\xb1\xda.?\xf9\xd5.\\tZ\xcd*\t\xb6b\x13\xdf\x0eX\xbd\xe8\xf4B\x1d\x1aJ\x98U?#\xc9\x82\xe0W\xc5\xd2\xfb\xb1\xb8\x13C\x90\xad*m\x06\x95@\xcc\xb4\xf0\xdb\x9a\t\x85\x16\xed\xd3\x84\x18\x11\xe3\x90Z\xbd\xab\x1a\x0bE&quot;</span></span><br><span class="line">, <span class="string">b&#x27;\x84\x876\xa9\xaf\xdd\x11\xdd;c\x99\xeb(\x8d\xe1\xcf\tL\xcf\x12I\xc5\xb4\tl\xaf3\x8ak&quot;a]\x11\x9bG\xf0\nL\x9f\xa0\xdc\xab\x0c\xeeD\x89\xc1\xb8\x15c\x93\xed)\x1d\xf8\xc2w\xb7\xea\xe2\xf5\xa4\x00*o\x13;\t\x11\xe4\xb5\n\xae&#123;\xd9\x8f\x00\n\x96w\x90\xd8?m\xe9\x9b\x11\xd5\xda\xf9\xdb\x91\xce\xa3\xba$\xe8\xfe\xde\xd3YZT\x95\xb1\xf6\xfcrWh\xd8T\x07Q\xdb\x98\xf8\xc3y\xcd_,\xa3\xb23\x88\xbb\xa2&#x27;</span></span><br><span class="line">,<span class="string">b&#x27;\x92?\xe0#\x01z\xf8\xa0\xe8c\xd8w\x9b\x19l\xa1\xba\xaf\xf5m2\x193\x96)\x13\x1c5\x12\xac\x9c\xba|\x19\xb8\xfe\xbe\xc8\xb7\xc0u\xe8&#123;G\x0f\xfa\x9d\x9d\xc0\x01\xbe\x08\x16\x15(;U)pH\xc1 b\xa6FR\xef\xa3\x11\x80\xef\xda\x97\xc0\x9e\\\xeds3Y\xf9B&#123;)&gt;\xed\x97\xf9q\x99\xb4\xb8\xe9A\x9f\x9e\xc6\x9bs\x0f\x12\xcd\x82\xf8ad7qH\x7f\x12\x11\x07\xa5Ws`w*\x15\xa1e6\xb7\x03\xdb\xde\x8d&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p=<span class="number">11591820199541996689109613653787526255588052136591796590965030492566464176562040269220119399461110340988231294335751866203503669710592217665562209443382247</span></span><br><span class="line">q=<span class="number">11635054504921733826196411324113633422484567025939176480557681377109499625813425045440075923029853047713076440712050521568931550034720072522577709065411181</span></span><br><span class="line">e=[<span class="number">65537</span>,<span class="number">68719476737</span>,<span class="number">4294967297</span>,<span class="number">1048577</span>,<span class="number">16777217</span>]</span><br><span class="line">n=<span class="number">134871459832923860099882590902411996710996766501756653086495354300954191050110475349218593219906710987168729946490859346117437393705213066464123381634516073655104369957424501917959364716066521838138728063315157921217685558557422845878448233922585713677077217815414960315913375048754314176130997193108410703707</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">    d=invert(e[i],phi)</span><br><span class="line">    m=<span class="built_in">pow</span>(bytes_to_long(enc[i]),d,n)</span><br><span class="line">    print(long_to_bytes(m))</span><br><span class="line"><span class="string">b&#x27;Hi everyone! Are you enjoing darkCON?\n&#x27;</span></span><br><span class="line"><span class="string">b&#x27;Hell yeah! Charlie, do you have the secret thing?\n&#x27;</span></span><br><span class="line"><span class="string">b&#x27;Got it! darkCON&#123;4m_I_n0t_supp0sed_t0_g1v3_d???&#125;\n&#x27;</span></span><br><span class="line"><span class="string">b&#x27;[Sush]...[Sussshhh]... Eve Eve...Eve is there!\n&#x27;</span></span><br><span class="line"><span class="string">b&quot;Nah...She doesn&#x27;t even have our Private Keys&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="2-Crypto-Take-It-Easy-99-solves-428-points"><a href="#2-Crypto-Take-It-Easy-99-solves-428-points" class="headerlink" title="2.Crypto/Take It Easy(99 solves / 428 points)"></a>2.Crypto/Take It Easy(99 solves / 428 points)</h2><p>先找到压缩包密码，密码解那个txt文件的rsa即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">147310848610710067833452759772211595299756697892124273309283511558003008852730467644332450478086759935097628336530735607168904129699752266056721879451840506481443745340509935333411835837548485362030793140972434873394072578851922470507387225635362369992377666988296887264210876834248525673247346510754984183551</span></span><br><span class="line">ct = <span class="number">43472086389850415096247084780348896011812363316852707174406536413629129</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">m=iroot(ct,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"><span class="comment">#key=Ju5t_@_K3Y</span></span><br></pre></td></tr></table></figure>
<p>分析源码可知，将flag分成了7个组然后隔着一个组两两异或。那就逐个恢复。</p>
<p>且由于第一组第二组明文已知</p>
<p>根据异或的对称性</p>
<p>即第一组异或第三组密文，第二组异或第四组密文。。</p>
<p>可以恢复第三第四组明文，然后再拿这两组继续操作，最后组合即可得到完整flag，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</span><br><span class="line">flag = <span class="string">b&quot;darkCON&#123;n0T_Th@t_haRd_r1Ght&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Tup_Int</span>(<span class="params">chunk</span>):</span></span><br><span class="line">	<span class="keyword">return</span> unpack(<span class="string">&quot;I&quot;</span>,chunk)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">chunks = [flag[i*<span class="number">4</span>:(i+<span class="number">1</span>)*<span class="number">4</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)//<span class="number">4</span>)]</span><br><span class="line">print(chunks)</span><br><span class="line">ciphertext = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(chunks) - <span class="number">2</span>):</span><br><span class="line">	block = pack(<span class="string">&quot;I&quot;</span>, Tup_Int(chunks[i]) ^ Tup_Int(chunks[i+<span class="number">2</span>]))</span><br><span class="line">	ciphertext = <span class="string">&#x27;B&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27; : &#x27;</span> + <span class="built_in">str</span>(block) + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">	print(ciphertext)</span><br><span class="line"><span class="comment">#darkCON&#123;n0T_Th@t_haRd_r1Ght&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-Crypto-Tony-And-James-45-solves-472-points"><a href="#3-Crypto-Tony-And-James-45-solves-472-points" class="headerlink" title="3.Crypto/Tony And James(45 solves / 472 points)"></a>3.Crypto/Tony And James(45 solves / 472 points)</h2><p>题目：（拿了个二血）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_seed</span>(<span class="params">l</span>):</span></span><br><span class="line">	seed = <span class="number">0</span></span><br><span class="line">	rand = random.getrandbits(l)</span><br><span class="line">	raw = <span class="built_in">list</span>()</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> rand &gt; <span class="number">0</span>:</span><br><span class="line">		rand = rand &gt;&gt; <span class="number">1</span></span><br><span class="line">		seed += rand</span><br><span class="line">		raw.append(rand)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(raw) == l:</span><br><span class="line">		<span class="keyword">return</span> raw, seed</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> get_seed(l)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">m</span>):</span></span><br><span class="line">	l = <span class="built_in">len</span>(m)</span><br><span class="line"></span><br><span class="line">	raw, seed = get_seed(l)</span><br><span class="line">	random.seed(seed)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;encrypted.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:	</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">			r = random.randint(<span class="number">1</span>, <span class="number">2</span>**<span class="number">512</span>)</span><br><span class="line">			<span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">				print(<span class="string">&quot;r0 =&quot;</span>,r)</span><br><span class="line">			encoded = <span class="built_in">hex</span>(r ^ m[i] ^ raw[i])[<span class="number">2</span>:]</span><br><span class="line">			f.write(<span class="string">f&quot;F<span class="subst">&#123;i&#125;</span>:  <span class="subst">&#123;encoded&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">	m = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read()</span><br><span class="line">	encrypt(m.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>先根据已知条件爆破出seed</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_seed</span>(<span class="params">l</span>):</span></span><br><span class="line">    seed = <span class="number">8926184294774128254</span></span><br><span class="line">    rand = <span class="number">8926184294774128254</span></span><br><span class="line">    raw = [<span class="number">8926184294774128254</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> rand &gt; <span class="number">0</span>:</span><br><span class="line">        rand = rand &gt;&gt; <span class="number">1</span></span><br><span class="line">        seed += rand</span><br><span class="line">        raw.append(rand)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(raw) == <span class="number">64</span>:</span><br><span class="line">        <span class="keyword">return</span> raw, seed</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> get_seed(l)</span><br><span class="line">raw, seed = get_seed(<span class="number">64</span>)</span><br><span class="line">print(raw)</span><br><span class="line">print(seed)</span><br><span class="line"><span class="comment">#seed=17852368589548256470</span></span><br></pre></td></tr></table></figure>
<p>然后根据异或的对称性解密即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#求出种子</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">seed=<span class="number">17852368589548256470</span></span><br><span class="line"></span><br><span class="line">random.seed(seed)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">raw=[<span class="number">8926184294774128254</span>, <span class="number">4463092147387064127</span>, <span class="number">2231546073693532063</span>, <span class="number">1115773036846766031</span>, <span class="number">557886518423383015</span>, <span class="number">278943259211691507</span>, <span class="number">139471629605845753</span>, <span class="number">69735814802922876</span>, <span class="number">34867907401461438</span>, <span class="number">17433953700730719</span>, <span class="number">8716976850365359</span>, <span class="number">4358488425182679</span>, <span class="number">2179244212591339</span>, <span class="number">1089622106295669</span>, <span class="number">544811053147834</span>, <span class="number">272405526573917</span>, <span class="number">136202763286958</span>, <span class="number">68101381643479</span>, <span class="number">34050690821739</span>, <span class="number">17025345410869</span>, <span class="number">8512672705434</span>, <span class="number">4256336352717</span>, <span class="number">2128168176358</span>, <span class="number">1064084088179</span>, <span class="number">532042044089</span>, <span class="number">266021022044</span>, <span class="number">133010511022</span>, <span class="number">66505255511</span>, <span class="number">33252627755</span>, <span class="number">16626313877</span>, <span class="number">8313156938</span>, <span class="number">4156578469</span>, <span class="number">2078289234</span>, <span class="number">1039144617</span>, <span class="number">519572308</span>, <span class="number">259786154</span>, <span class="number">129893077</span>, <span class="number">64946538</span>, <span class="number">32473269</span>, <span class="number">16236634</span>, <span class="number">8118317</span>, <span class="number">4059158</span>, <span class="number">2029579</span>, <span class="number">1014789</span>, <span class="number">507394</span>, <span class="number">253697</span>, <span class="number">126848</span>, <span class="number">63424</span>, <span class="number">31712</span>, <span class="number">15856</span>, <span class="number">7928</span>, <span class="number">3964</span>, <span class="number">1982</span>, <span class="number">991</span>, <span class="number">495</span>, <span class="number">247</span>, <span class="number">123</span>, <span class="number">61</span>, <span class="number">30</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">F=[<span class="number">0x17e5b42a8bea57da669427727314c1b5b50a7c11135d48d87fac2aa91c1e96a62c3e815724c0fd9fd338fa7d65e390525a1294fbaa2655e563657b5e699bb732</span>,</span><br><span class="line"><span class="number">0x8d0a0f04d961cb770b28101de8ec775ed16656d32b1e1f7c38b880633954550fc90f6ad1b73895ff65e2edc46e3413e7cc5b234ca2ff25c4eb52ab9a4964e86a</span>,</span><br><span class="line"><span class="number">0xbcf77a6a978c03b4c36ab21d93decf3f218b7f0716fb68276cc64b45754a954f113f8e42077683f793affdd9b9cdf82e0ba2a1428ca408f37694dc721500def</span>,</span><br><span class="line"><span class="number">0xfe42c2d038326f7fc6167eede667c164f85e9dafac7fadea6021bc1dca3f2c6450fb2f5dcd21fc93c352b59d9570abe8660b79ce990830e67a3624ea27a1f369</span>,</span><br><span class="line"><span class="number">0xb7b07abebdb05ed0129ae97f36fd394e74b3371024e2ba4474aee42d410a783dec0598cd1ef32d03234c5426256e966084c98f69bf9a6a1b7b37aad7bc45ffaf</span>,</span><br><span class="line"><span class="number">0x8ebad316ac19807114dedf2bcb3fb398500e978cd8ef7ccad2ac2e77728e729bb8732db6aaf82551d98f1fa0dfd5d38ecbe5e8c1a20bfe72daba8f22f5fa6371</span>,</span><br><span class="line"><span class="number">0x964188a77c0b800fb6a18b6e233f8a0c4185cce96f148d1f8114bf0865a89656d98475b170618861ce86a343ca682423dfcbb9d65285a7e4181089eab827ac6f</span>,</span><br><span class="line"><span class="number">0xd7732af5b47f66d22ce4dba419a4aa49309ea7b6ccac1bbce09186283b66611cbbfce808e4a428b8341564e702a2004a690df7c589bda8956e5b92db69e7b36d</span>,</span><br><span class="line"><span class="number">0xed5b0c69b240ee406df5e4ed7fe355408a307c4b5423546c99d6f5011e9b69de2c45227460bd5520da15ec3dcbab3f07c50ead4c1d4eb202a4a2764f5c3f9208</span>,</span><br><span class="line"><span class="number">0x116468b05dd6f53ae07c96e2f5e89eeda11cc17cff0a1659ae517ce7268bfbc31cc2bd368782476fdd96f067e6831891c5cc1c50df07d9d937dc9c45cdaac132</span>,</span><br><span class="line"><span class="number">0x10b0bec20c0a74bf9fb3fa17966ccddeda04f91923e9361ded969b5d16699174d184258f27d3f083dd1b382fa6f3ec228d053c593a4bef0adec487b5f4f98be2</span>,</span><br><span class="line"><span class="number">0x3a02d0ca2364d7b397b486fc73f8a73f3fa351e3367e28e70851e9af53d1235abb1567d4ddb47e63c7449ddfd3d5aecd7770bb5c15a72fbb69605757753ce1d</span>,</span><br><span class="line"><span class="number">0xd7c2a7f613dd92e811c28171e190b743bbfa0875931cbe7326cc5e72e45ce767f9854c9a70fbd93fd56a590ad3c6d16c1815a6f4595e7005ea3237835bbc3587</span>,</span><br><span class="line"><span class="number">0xb6bfbf43b10d1e98a5d2fe20dc3d805e0c3e4ed170ee3c6c3881c23f3d8ad10d043e17155abdf6d870dae209a64435c2de33d8181e805e675d8d5636395c43f8</span>,</span><br><span class="line"><span class="number">0x14405e18dcc3bf9dc143d0476d06e8c307cd3354ff19f81053627ac88cafe404c9d7552ac29ae90c8f3cd71d9a433722cb4b0aeff61ca581031c8abc32fa6d31</span>,</span><br><span class="line"><span class="number">0x93aaf3c9e80ed96a88d3b5c8234c6ff169db2a860a6c9a501f3ce1a78c87eb4177ffe30c35968ae91d7e75ec401b78d771edad4696da6392685607ca3ac42c0e</span>,</span><br><span class="line"><span class="number">0x6c50dcb1ddc1ee575e86971db3f14f00cb03ca8f457b9cbc4fa7a19466fdafc91b96e88f083ff80748eda149879b9b671b95cb79e2b09432c8f25819caf60ada</span>,</span><br><span class="line"><span class="number">0xb1d7efc822d3cea04cbc5324a78c9025b10a6412c237cdb4fea182336d9dc75e45e578f85b7c122ace5c2dc817a118f1245300f016bca14324577ec75e326a7b</span>,</span><br><span class="line"><span class="number">0x365fc095493db65e35ad3d17ab6bb4b9bc764f74fcf1d865b41d9636ca4ec7980a17a42b06f7888fd38554f3803371d2f9a709ca6591d7bb1a053c82abe9352a</span>,</span><br><span class="line"><span class="number">0xc2c9f3a7aa6752a69dabfdbeaa222bc205278bb7034bc6993875efcb3680e69c7c01a4432ec9d5e85484ba5dd291c6e630a352650c8ebf694ea40a8e12a1b32f</span>,</span><br><span class="line"><span class="number">0xdcb706df8883899c746efad75ff21e6d2be56a93386329c28ba7c1ac2d87b33ed1b103903396e304f48e3743a31b1e477aecc8a7dcb563509b3d69bf6621526c</span>,</span><br><span class="line"><span class="number">0x240b973fa722be5cedb366a3f3f36c3964d14cc273cde00f4834eb9c08acc3a0f38f500d37bc66893b26c94677da629cfca810fd84fc679ee2190480433e2a0f</span>,</span><br><span class="line"><span class="number">0xf79a9c1758da10c6363ec6e8a8f15af81eac25ae794597cd2928787a5ec7dc851a8278f473144d5269619822e37090d3f18318f5c67fc6bd9de9429c917851a4</span>,</span><br><span class="line"><span class="number">0x839025bc53a823c8a1c5a5d76c64b656122a1c89043070110de1b5ced0ea529e53dd5802d240e7bc511a0e79071e7b4214bafb5414f2ab62184d5677cc47b024</span>,</span><br><span class="line"><span class="number">0x2132673aeac17a2a2a1fbf3a8ab2436e654a0c5eed945fedce3bdfa8b5c4b89bf8840ad57aa97a669b4021cd3486d408310ef7ebf9bdd226d95fa5f98ff07023</span>,</span><br><span class="line"><span class="number">0xa3a17c8d8ef3b9358130a5fbf5b50f71060e66779e67fc6837e637ca51efcd9bdf02921c1c28e859ec1bdcbae45aede19782c3109c09fa4efc63a03e8ef53685</span>,</span><br><span class="line"><span class="number">0x121cf2f4c025f605d770eff32c0786774705577e325ffe7841c23d194f517bb9d3cb849992bdb2d89089cb320dfe9829e732ac96de0a0f99e683b08e30e2f0f3</span>,</span><br><span class="line"><span class="number">0x4c3c85a42e907ed36f724c3b70124ce5d2214bfb42ffe997cec22596e3129180339a4589b89824e00a9424a5308b6bad3aeb78ddceff1005ed5d53261fc12077</span>,</span><br><span class="line"><span class="number">0xbe08bb264014f63c1caceb07a92a8ad6aecb4d2a3268f73f5d3d53b1256f20ba15c64e00b43e8555d5424c99118d6a7db06fa63ae16b8fa75587f735c562a8fd</span>,</span><br><span class="line"><span class="number">0x9f985f7342103394f7e91ebddf3620461694f6ee07bd4c3129884a0069cf9bcf827123e1e647b6efc63bee1688a72a22af9017f13d4788ff71b78090c23422c2</span>,</span><br><span class="line"><span class="number">0x46421b56a4e97debd4c3e4f8d4b1575d7dbb9cd7f14978b81c673a71499dab7665bae198190554997621edeec45e687d0c0747714f302b2c48081313bcedb56f</span>,</span><br><span class="line"><span class="number">0xa400e922efde652354894da17396b9148ede9ff06584815ce27de846d7f30d9b2c42e5ce05f03aac3ac42561e5e1d618a2b6279291bf967297b1e45f0468987d</span>,</span><br><span class="line"><span class="number">0x94aa1a26e4ac93ae0b9195be95a365dbc190b03e90766658a4ad21bb0591d7b0ded29c44df528f9194e561970cb15266c300e864df4d0ebc315589990117c2ce</span>,</span><br><span class="line"><span class="number">0x287fa54e7d8bd73d3f7b96702a0baacb624fd7c3220fa13e7ff8c19ce547aab324f555affb90a61e97a785c0ea4ff627e2eda1e35a1124c05427fc5bdc1788a3</span>,</span><br><span class="line"><span class="number">0x95ee463c23d1146e86f9978a7dc390302127149c8b78c60316d11e57e215d629c7118c7104105fbd2fd1738e828390ec49f78f39c6bd2cb790d90395c5c0997f</span>,</span><br><span class="line"><span class="number">0x7d623aa01509d0380805a7b333f97ef8d9670d90c4f913c616d197d17714f026bd8c50ee571b8d38cc540cc24ff0ec601fedd0f54428eed48d8c3903868d6934</span>,</span><br><span class="line"><span class="number">0x832066a95dd7514b7a5b2aac82e90512fcadfc06c3d50b95a8e981a252b006b482fc8c8a1b85b79c8979d8d98856836a583b0fb295ddfbcb6a7a111f752a101d</span>,</span><br><span class="line"><span class="number">0x2297e2ae6f70d25069a16adac93d92696d0daf62930e4e870b457b12ff49d6776e77adbed5215d73c796ebf33e80b922b80a76e6a52e4612bc1b0facba47f4a6</span>,</span><br><span class="line"><span class="number">0x79186e494573075b2b1ca356523e7d123f260a25e32074ff90a31c5d9c993a87d3a9a81377f750bb9b00f57c76eceb54edfd82e7162344259d2b37a8a2d90ec5</span>,</span><br><span class="line"><span class="number">0x81859b0c047178bab149f7bfc5e4fd84a3b77f34c6b4af8210f9f22644ca9c6e2357f453c54f39984a97b38101f42d44928b29f5a66eae9d6620a09851b47d1e</span>,</span><br><span class="line"><span class="number">0x48dabebf34300f1527a002359f6d3c163ac592d9e8b5fb4b3f8abf66a0729311c46fa662fa2f7400e05d7c5d27515ade9cc08d2512368fc2e32410a59c9fb70f</span>,</span><br><span class="line"><span class="number">0x132769a2e99ba475a56d1260f34a352954c5be314fb4cf7f35a4a636eed5e1d3d756776119c1dd27f2dc75a06c078f179d551ee15f604b928d1b60d5fd7701c3</span>,</span><br><span class="line"><span class="number">0x77d58d49a7c9131f37b79e281e0bc74717f31e608d896c71d6c371b8029be344c0d261326eaffb0be5a4cde37483159f2d141a6865b29ad8e1ff7e514d87cfcc</span>,</span><br><span class="line"><span class="number">0x3fad5058ae8b0e1af806f10f344750f7793274076b3401481da3fd654db9c0f12cfcbca7578f835ed9b362a878c7b9b1a144b06a875cf893d6d52af0019ee697</span>,</span><br><span class="line"><span class="number">0x957877839a1d9091df2d611a2243f3a481c1aa2af3454738066530a732a658968c1bc77394a063c557f8da99972a7d824b4aa045dd287ba0ec9ceaa9d4e58aef</span>,</span><br><span class="line"><span class="number">0x971995976225cca200f7664298dfebc3d72a428d042dead744019a7c84f106821baa6c6dc096453cf3eaf3109c66d7b50e214de59e89e2b5c04c4d90626ede11</span>,</span><br><span class="line"><span class="number">0x27cb279b7ff24e62f98b77f75ebbbbe7c7fa31018e2d345aa21de2b8c56e8bfbb5c383b7cb98fc1a49c9d82f497b7a6a36d7acf94ee1a5d891ac7cb4bae56a72</span>,</span><br><span class="line"><span class="number">0x8ac5151ce5eaca335347fc76d7273ed1dc42722221ae27a85a3f8d095025ebe8f4e6ce5a5dea6a263175e4612b6d673307aee0da5b8aff94f8bace77b1b6f54</span>,</span><br><span class="line"><span class="number">0xef55689d6f3de7bfb109803a861aa25310cc9542ed31503fd8ea376d08f81d60af09402b142c2c2d13297f2f129d79aeabfb14a5553f25570322f58252487c23</span>,</span><br><span class="line"><span class="number">0x9937349c6aecc5c533fd1aee1f5e1ab4c7bfaf078d3f03f4b30a4b4e039052bfe6060fb1a1bb39d340145387910307761c5474a2c37fa6591920a513adff2c66</span>,</span><br><span class="line"><span class="number">0xe5839710f0f7fd77cd4880e185547f678653980b213c92dd7cbe10cf0da9315a998d2fe9c8c009060a954fd8a2cddf7a19b410970b8dbb56629eddade8ed9ee5</span>,</span><br><span class="line"><span class="number">0xfff4a1773df4e303411dbd103db2147d4f49eb2153e043848c72fb442855acd5f71321d246d21cb9a9b1ed79cc384994ff68aaf4e46ab5b3f4c94f2fb68d8441</span>,</span><br><span class="line"><span class="number">0x1a97ef902380ec2223a8a756ef3351d18230b620d3cef0c49596d24f762f047dc148b1e82ac3d1e94ca8702cbea5cbc0cdf841d3b23d062182580b2fce1624cb</span>,</span><br><span class="line"><span class="number">0xbe2118c7db2f8677f6906d2fe92697c86c72dd4644ef87afe0bcbb7d9ebb516a80259c708831fe7b85c5dfb0215665a7ec17bc7852a34addb9160a05b0b5a2c</span>,</span><br><span class="line"><span class="number">0x6c0e643a08ab186d2ad85a1b0346921ceac406326957d8e79f0f56c6a00f51b9d14693b364fa7be3bbee2e527e9bcb73e4260782577aeb777be27a3e296b5e03</span>,</span><br><span class="line"><span class="number">0xc1bb2f017d2c30e8c91295dc6784184799913c68cc7ee11f7cd328e25c94413dcba0cc7d92ec7b170db0bef34648ce90882a9fb5ff3ccbc8f4786286f124a4ff</span>,</span><br><span class="line"><span class="number">0xcf5a857feb8f483847a193977ed6532b5a3b3f6d4bfd3c21507f66ce18bcc987f3b104b1f3e657028d8ce7c87a6b1d5b327db2568cd209c8d343b67943620250</span>,</span><br><span class="line"><span class="number">0x4a2b2cdbdf3d70c98b3ad872548ce258b32607f370dfc32d030ebffa731720804e3f751597c0bb80cd878a0d4f8a4b7120f35536f2f8831f095786f543e476a5</span>,</span><br><span class="line"><span class="number">0x3f20ac7028148dcde2fa827fad44e3c4263483f7fa879a6f1e99367ea1a6a4da527ed234c968efcf9423872e47a2d94fcd20d847578ab5ff30a358902b1e2787</span>,</span><br><span class="line"><span class="number">0xedd001110c436c4ccc30e11b5c959be8105a6c58920d50c95e987e0f8cb76619db2c88aebda7b30735d64776ead85c1a71bcb0e5699a6e4286b050a141f5d8b2</span>,</span><br><span class="line"><span class="number">0x1e28e7ad45184e920fb58d14b7d699c901507f6eee8532a88936f90550fcf33f969d5a9e35ebd475714d43a0a663ac31733c0230b9e47cd7783407558cdc4402</span>,</span><br><span class="line"><span class="number">0xc174e180053198d2dded1ed14af14e475eb52d6138278c321026367a22b1ed4e4cf1c09f7d9e8c94d3c11044d474a85e46e5195f7463ece07ea45b4c79c096a5</span>,</span><br><span class="line"><span class="number">0x81983d3b4612607ad124083463d3718e1840ce56c386274354a761298c94c468393ae5d62a216ce16448a35c1570d06241665929dc723fdda7fdffe0b307b93b</span>,</span><br><span class="line"><span class="number">0x70c066054fe3e43dddd7eb7cf56ba5c7e25ff915ee8c6edf6fa2eb462aaa13f676d875be734a68628a54cd18a8e9503d41bc2535058d3ac3732807656730576a</span></span><br><span class="line">]</span><br><span class="line">m=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(F)):</span><br><span class="line">    r = random.randint(<span class="number">1</span>, <span class="number">2</span> ** <span class="number">512</span>)</span><br><span class="line">    print(r)</span><br><span class="line">    decoded = r ^ F[i] ^ raw[i]</span><br><span class="line">    m.append(decoded)</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(F)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(m[i])</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#darkCON&#123;user_W4rm4ch1ne68_pass_W4RM4CH1N3R0X_t0ny_h4cked_4g41n!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="4-Crypto-Rookie’s-Choice-4-you-51-solves-467-points"><a href="#4-Crypto-Rookie’s-Choice-4-you-51-solves-467-points" class="headerlink" title="4.Crypto/Rookie’s_Choice_4_you(51 solves / 467 points)"></a>4.Crypto/Rookie’s_Choice_4_you(51 solves / 467 points)</h2><p>RC4,已知明文攻击。</p>
<p>知道flag密文位数为96位（十六进制）故，flag明文为48位。且给了另外一组明文F（大于48位）+密文E，那么我们截取出48位F的明文和其对应的密文E进行异或可以恢复出密码流key。</p>
<p>恢复的密码流key后再与flag密文异或即可恢复明文。</p>
<p>脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"></span><br><span class="line">s=<span class="string">b&#x27;abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuv&#x27;</span></span><br><span class="line">print(bytes_to_long(s))</span><br><span class="line">print(<span class="built_in">hex</span>(<span class="number">14988820073418128993386148956818953188503689820749454652493179315838436508934291518672867984704712115785893521159542</span>))</span><br><span class="line">a1=<span class="number">0x6162636465666768696a6b6c6d6e6f707172737475767778797a6162636465666768696a6b6c6d6e6f70717273747576</span></span><br><span class="line">a2=<span class="number">0x3d5d841c4df203758189060d7ba5ef0460c90faeae890dc621dfb563a03cc5f728d42794ae8a08102f2766acece427f3</span></span><br><span class="line">key=<span class="number">14198516887274407798935983314536536148442235170437936307787791383244210245090358526986615445961133532508012229448325</span></span><br><span class="line">enc=<span class="number">0x385e95136bdb2a66baa0593e27b8df03228f1785ea9925c768d08b74b06bffe27bd17da1aed51c21342026bdacb173f8</span></span><br><span class="line">print(long_to_bytes(key^enc))</span><br><span class="line">encc=<span class="number">0x6c0fd74818a4542dd8d35d5126fbb044218b4ceaebcf4a8e6895e431f36890a17f8c7ecef5d6554e706727eeafa062b5</span></span><br><span class="line">print(long_to_bytes(key^encc))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;darkCON&#123;RC4_1s_w34k_1f_y0u_us3_s4m3_k3y_tw1c3!!&#125;&#x27;</span></span><br><span class="line"><span class="comment">#b&#x27;000000000000000000000000000000000000000000000000&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="5-Crypto-PokePark-Raising-New-Generation-6-solves-497-points"><a href="#5-Crypto-PokePark-Raising-New-Generation-6-solves-497-points" class="headerlink" title="5.Crypto/PokePark - Raising New Generation        (6 solves / 497 points)"></a>5.Crypto/PokePark - Raising New Generation        (6 solves / 497 points)</h2><blockquote>
<p>根据交互后的信息可以知道，给出10个数猜出下一个数。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 3.16.14.62 5000</span><br></pre></td></tr></table></figure>
<p>猜测可能是考LCG，未知a,b,n.</p>
</blockquote>
<p>先给出LCG的形式：<br>$$<br>x_{n+1}= (x_{n}*a+b) mod n<br>$$<br>先求n,发现，试了几组，发现有一个共同的n，n=2147483647.故用此n反求a和b，再以题目最后一个数位seed生成下一个数。</p>
<p>完整代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd,invert</span><br><span class="line">s=[<span class="number">1110334286</span>,</span><br><span class="line"> <span class="number">1902936019</span>,</span><br><span class="line"> <span class="number">171716562</span>,</span><br><span class="line"> <span class="number">1969719613</span>,</span><br><span class="line"> <span class="number">1617117186</span>,</span><br><span class="line"> <span class="number">335508670</span>,</span><br><span class="line"> <span class="number">1749643315</span>,</span><br><span class="line"> <span class="number">761616834</span>,</span><br><span class="line"> <span class="number">1491592918</span>,</span><br><span class="line"> <span class="number">1625561395</span></span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    t.append((s[i]-s[i-<span class="number">1</span>]))</span><br><span class="line">all_n = []</span><br><span class="line">print(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    all_n.append(gcd((t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>]-t[i]*t[i]), (t[i+<span class="number">2</span>]*t[i]-t[i+<span class="number">1</span>]*t[i+<span class="number">1</span>])))</span><br><span class="line">print(all_n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> all_n:</span><br><span class="line">    <span class="comment"># n=abs(n)</span></span><br><span class="line">    print(n)</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n =  <span class="number">2147483647</span></span><br><span class="line">output =  [<span class="number">761616834</span>,</span><br><span class="line"> <span class="number">1491592918</span>,</span><br><span class="line"> <span class="number">1625561395</span>]</span><br><span class="line">d=inverse((output[<span class="number">1</span>]-output[<span class="number">0</span>]),n)</span><br><span class="line">a=(output[<span class="number">2</span>]-output[<span class="number">1</span>])*inverse((output[<span class="number">1</span>]-output[<span class="number">0</span>]),n)%n</span><br><span class="line">ani=inverse(a,n)</span><br><span class="line">b=(output[<span class="number">1</span>]-a*output[<span class="number">0</span>])%n</span><br><span class="line">print(a,b)</span><br><span class="line">a=<span class="number">16807</span></span><br><span class="line">b=<span class="number">0</span></span><br><span class="line">n=<span class="number">2147483647</span></span><br><span class="line">print(<span class="string">&quot;x=&quot;</span>+<span class="built_in">str</span>((a*<span class="number">1625561395</span>+<span class="number">0</span>)%n))</span><br><span class="line"><span class="comment">#next=523408631</span></span><br></pre></td></tr></table></figure>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210222192304009.png" alt="image-20210222192304009"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#flag:darkCON&#123;P0k3m0ns_4nd_RNG!!!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="6-Crypto-MIMT"><a href="#6-Crypto-MIMT" class="headerlink" title="6.Crypto/MIMT"></a>6.Crypto/MIMT</h2><p>待复现补充</p>
<h2 id="7-Crypto-Disguised-Wordlets"><a href="#7-Crypto-Disguised-Wordlets" class="headerlink" title="7.Crypto/Disguised Wordlets"></a>7.Crypto/Disguised Wordlets</h2><p>待复现补充</p>
<h1 id="REV"><a href="#REV" class="headerlink" title="REV"></a>REV</h1><h2 id="1-Reverse-Read"><a href="#1-Reverse-Read" class="headerlink" title="1.Reverse/Read"></a>1.Reverse/Read</h2><h2 id="2-Reverse-Too-Much"><a href="#2-Reverse-Too-Much" class="headerlink" title="2.Reverse/Too Much"></a>2.Reverse/Too Much</h2><h2 id="3-Reverse-ezpz"><a href="#3-Reverse-ezpz" class="headerlink" title="3.Reverse/ezpz"></a>3.Reverse/ezpz</h2></div></article></div></main><footer><div class="paginator"><a href="/2021/02/22/2021-hgame-week4-Crypto/" class="prev">PREV</a><a href="/2021/02/21/Crypto-LSFR/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>